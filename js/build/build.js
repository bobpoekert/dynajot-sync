(function(){function S(){Object.defineProperty(this.cache={},0,{get:function(){return{}}});this.expando=Math.random()}var Q={},s={},Ja=localStorage.getItem("djc:session_id");Ja?s.session_id=Ja:(s.session_id=Math.floor(1E16*Math.random()).toString(),localStorage.setItem("djc:session_id",s.session_id));s.session_id+="-"+Math.floor(1E3*Math.random());s.counter=function(a){var b=localStorage.getItem("djc:"+a),b=parseInt(b||0,10);localStorage.setItem("djc:"+a,(b+1).toString());return b};s.global_timestamp=
function(a,b){var c="gs:"+a,d=parseInt(localStorage.getItem("djc:"+c)||0,10);b&&b>d?(localStorage.setItem("djc:"+c,b.toString()),c=b):c=d;return c};s.node_ctr=function(){return s.counter("node_ctr")};s.message_ctr=function(a){return s.counter("message_ctr:"+a)};s.node_id=function(a){return[s.session_id,a,s.node_ctr()].join("-")};s.message_id=function(a){return[a,s.global_timestamp(a),s.session_id,s.message_ctr(a)]};Q.module$exports=s;Q.module$exports&&(Q=Q.module$exports);var W={},ha={random_string:function(a){for(var b=
[],c=0;c<a;c++)b.push(String.fromCharCode(Math.floor(26*Math.random())+97));return b.join("")}},ia=!1,xa=[],ja=function(){if(!ia)for(ia=!0;0<xa.length;)xa.pop()()};if("complete"==document.readyState||"undefined"==typeof document.readyState&&(document.getElementsByTagName("body")[0]||document.body))ja();else if(document.addEventListener)document.addEventListener("DOMContentLoaded",ja,!1);else if(document.attachEvent){var ya;ya=function(){"complete"==document.readyState&&(ja(),document.detachEvent("onreadystatechange",
ya))};document.attachEvent("onreadystatechange",ya)}else{var Ka;Ka=setInterval(function(){if(ia||/loaded|complete/.test(document.readyState))ja(),clearInterval(Ka)},10)}ha.onReady=function(a){ia?a():xa.push(a)};ha.create=function(a,b,c,d){if(!d)a:{for(;;)if(d=ha.random_string(10),!document.getElementById(d))break a;d=void 0}b=b||{};c=c||{};b.width=b.width||1;b.height=b.height||1;var g;if((new ActiveXObject("ShockwaveFlash.ShockwaveFlash")).getVariable("$version")){g=document.createElement("div");
g.style.visibility="hidden";g.setAttribute("id",d);var d=[],f;for(f in b)if(b.hasOwnProperty(f))switch(f.toLowerCase()){case "styleclass":d.push(' class="');d.push(b[f]);d.push('"');break;case "classid":d.push(' classid="');d.push(b[f]);d.push('"');break;default:d.push(" "),d.push(f),d.push('="'),d.push(b[f].replace('"',"%22")),d.push('"')}c.movie=a;a=[];for(f in c)c.hasOwnProperty(f)&&(a.push('<param name="'),a.push(f),a.push('" value="'),a.push(c[f]),a.push('"> '));g.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+
d.join("")+">"+a.join("")+"</object>";return document.getElementById("id").firstChild}g=document.createEleement("object");g.setAttribute("type","application/x-shockwave-falsh");for(f in b)b.hasOwnProperty(f)&&("styleclass"==f.toLowerCase()?g.setAttribute("class",b[f]):g.setAttribute(f,b[f]));for(f in c)c.hasOwnProperty(f)&&(a=document.createElement("param"),a.setAttribute("name",f),a.setAttribute("value",c[f]),g.appendChild(a));g.style.visibility="hidden";document.body.appendChild(g)};W.module$exports=
ha;W.module$exports&&(W=W.module$exports);var X={},ka={},v=Array.prototype,La=Object.prototype,za=v.push,q=v.slice,la=v.concat,Y=La.toString,cb=La.hasOwnProperty,Ma=v.forEach,Na=v.map,Oa=v.reduce,Pa=v.reduceRight,Qa=v.filter,Ra=v.every,Sa=v.some,ma=v.indexOf,Ta=v.lastIndexOf,db=Array.isArray,eb=Object.keys,Aa=Function.prototype.bind,e=function(a){if(a instanceof e)return a;if(!(this instanceof e))return new e(a);this._wrapped=a};e.VERSION="1.5.1 (hacked for requirejs)";var u=e.each=e.forEach=function(a,
b,c){if(null!=a)if(Ma&&a.forEach===Ma)a.forEach(b,c);else if(a.length===+a.length)for(var d=0,g=a.length;d<g&&b.call(c,a[d],d,a)!==ka;d++);else for(var f=e.keys(a),d=0,g=f.length;d<g&&b.call(c,a[f[d]],f[d],a)!==ka;d++);};e.map=e.collect=function(a,b,c){var d=[];if(null==a)return d;if(Na&&a.map===Na)return a.map(b,c);u(a,function(a,f,l){d.push(b.call(c,a,f,l))});return d};e.reduce=e.foldl=e.inject=function(a,b,c,d){var g=2<arguments.length;null==a&&(a=[]);if(Oa&&a.reduce===Oa)return d&&(b=e.bind(b,
d)),g?a.reduce(b,c):a.reduce(b);u(a,function(a,l,e){g?c=b.call(d,c,a,l,e):(c=a,g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");return c};e.reduceRight=e.foldr=function(a,b,c,d){var g=2<arguments.length;null==a&&(a=[]);if(Pa&&a.reduceRight===Pa)return d&&(b=e.bind(b,d)),g?a.reduceRight(b,c):a.reduceRight(b);var f=a.length;if(f!==+f)var l=e.keys(a),f=l.length;u(a,function(e,m,p){m=l?l[--f]:--f;g?c=b.call(d,c,a[m],m,p):(c=a[m],g=!0)});if(!g)throw new TypeError("Reduce of empty array with no initial value");
return c};e.find=e.detect=function(a,b,c){var d;Ua(a,function(a,f,l){if(b.call(c,a,f,l))return d=a,!0});return d};e.filter=e.select=function(a,b,c){var d=[];if(null==a)return d;if(Qa&&a.filter===Qa)return a.filter(b,c);u(a,function(a,f,l){b.call(c,a,f,l)&&d.push(a)});return d};e.reject=function(a,b,c){return e.filter(a,function(a,g,f){return!b.call(c,a,g,f)},c)};e.every=e.all=function(a,b,c){b||(b=e.identity);var d=!0;if(null==a)return d;if(Ra&&a.every===Ra)return a.every(b,c);u(a,function(a,f,l){if(!(d=
d&&b.call(c,a,f,l)))return ka});return!!d};var Ua=e.some=e.any=function(a,b,c){b||(b=e.identity);var d=!1;if(null==a)return d;if(Sa&&a.some===Sa)return a.some(b,c);u(a,function(a,f,l){if(d||(d=b.call(c,a,f,l)))return ka});return!!d};e.contains=e.include=function(a,b){return null==a?!1:ma&&a.indexOf===ma?-1!=a.indexOf(b):Ua(a,function(a){return a===b})};e.invoke=function(a,b){var c=q.call(arguments,2),d=e.isFunction(b);return e.map(a,function(a){return(d?b:a[b]).apply(a,c)})};e.pluck=function(a,b){return e.map(a,
function(a){return a[b]})};e.where=function(a,b,c){return e.isEmpty(b)?c?void 0:[]:e[c?"find":"filter"](a,function(a){for(var c in b)if(b[c]!==a[c])return!1;return!0})};e.findWhere=function(a,b){return e.where(a,b,!0)};e.max=function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.max.apply(Math,a);if(!b&&e.isEmpty(a))return-Infinity;var d={computed:-Infinity,value:-Infinity};u(a,function(a,f,l){f=b?b.call(c,a,f,l):a;f>d.computed&&(d={value:a,computed:f})});return d.value};e.min=
function(a,b,c){if(!b&&e.isArray(a)&&a[0]===+a[0]&&65535>a.length)return Math.min.apply(Math,a);if(!b&&e.isEmpty(a))return Infinity;var d={computed:Infinity,value:Infinity};u(a,function(a,f,l){f=b?b.call(c,a,f,l):a;f<d.computed&&(d={value:a,computed:f})});return d.value};e.shuffle=function(a){var b,c=0,d=[];u(a,function(a){b=e.random(c++);d[c-1]=d[b];d[b]=a});return d};var Ba=function(a){return e.isFunction(a)?a:function(b){return b[a]}};e.sortBy=function(a,b,c){var d=Ba(b);return e.pluck(e.map(a,
function(a,b,l){return{value:a,index:b,criteria:d.call(c,a,b,l)}}).sort(function(a,b){var c=a.criteria,d=b.criteria;if(c!==d){if(c>d||void 0===c)return 1;if(c<d||void 0===d)return-1}return a.index-b.index}),"value")};var Ca=function(a){return function(b,c,d){var g={},f=null==c?e.identity:Ba(c);u(b,function(c,e){var m=f.call(d,c,e,b);a(g,m,c)});return g}};e.groupBy=Ca(function(a,b,c){(e.has(a,b)?a[b]:a[b]=[]).push(c)});e.indexBy=Ca(function(a,b,c){a[b]=c});e.countBy=Ca(function(a,b){e.has(a,b)?a[b]++:
a[b]=1});e.sortedIndex=function(a,b,c,d){for(var c=null==c?e.identity:Ba(c),b=c.call(d,b),g=0,f=a.length;g<f;){var l=g+f>>>1;c.call(d,a[l])<b?g=l+1:f=l}return g};e.toArray=function(a){return!a?[]:e.isArray(a)?q.call(a):a.length===+a.length?e.map(a,e.identity):e.values(a)};e.size=function(a){return null==a?0:a.length===+a.length?a.length:e.keys(a).length};e.first=e.head=e.take=function(a,b,c){return null==a?void 0:null==b||c?a[0]:q.call(a,0,b)};e.initial=function(a,b,c){return q.call(a,0,a.length-
(null==b||c?1:b))};e.last=function(a,b,c){return null==a?void 0:null==b||c?a[a.length-1]:q.call(a,Math.max(a.length-b,0))};e.rest=e.tail=e.drop=function(a,b,c){return q.call(a,null==b||c?1:b)};e.compact=function(a){return e.filter(a,e.identity)};var Va=function(a,b,c){if(b&&e.every(a,e.isArray))return la.apply(c,a);u(a,function(a){e.isArray(a)||e.isArguments(a)?b?za.apply(c,a):Va(a,b,c):c.push(a)});return c};e.flatten=function(a,b){return Va(a,b,[])};e.without=function(a){return e.difference(a,q.call(arguments,
1))};e.uniq=e.unique=function(a,b,c,d){e.isFunction(b)&&(d=c,c=b,b=!1);var c=c?e.map(a,c,d):a,g=[],f=[];u(c,function(c,d){if(b?!d||f[f.length-1]!==c:!e.contains(f,c))f.push(c),g.push(a[d])});return g};e.union=function(){return e.uniq(e.flatten(arguments,!0))};e.intersection=function(a){var b=q.call(arguments,1);return e.filter(e.uniq(a),function(a){return e.every(b,function(b){return 0<=e.indexOf(b,a)})})};e.difference=function(a){var b=la.apply(v,q.call(arguments,1));return e.filter(a,function(a){return!e.contains(b,
a)})};e.zip=function(){for(var a=e.max(e.pluck(arguments,"length").concat(0)),b=Array(a),c=0;c<a;c++)b[c]=e.pluck(arguments,""+c);return b};e.object=function(a,b){if(null==a)return{};for(var c={},d=0,g=a.length;d<g;d++)b?c[a[d]]=b[d]:c[a[d][0]]=a[d][1];return c};e.indexOf=function(a,b,c){if(null==a)return-1;var d=0,g=a.length;if(c)if("number"==typeof c)d=0>c?Math.max(0,g+c):c;else return d=e.sortedIndex(a,b),a[d]===b?d:-1;if(ma&&a.indexOf===ma)return a.indexOf(b,c);for(;d<g;d++)if(a[d]===b)return d;
return-1};e.lastIndexOf=function(a,b,c){if(null==a)return-1;var d=null!=c;if(Ta&&a.lastIndexOf===Ta)return d?a.lastIndexOf(b,c):a.lastIndexOf(b);for(c=d?c:a.length;c--;)if(a[c]===b)return c;return-1};e.range=function(a,b,c){1>=arguments.length&&(b=a||0,a=0);for(var c=arguments[2]||1,d=Math.max(Math.ceil((b-a)/c),0),g=0,f=Array(d);g<d;)f[g++]=a,a+=c;return f};var Da=function(){};e.bind=function(a,b){var c,d;if(Aa&&a.bind===Aa)return Aa.apply(a,q.call(arguments,1));if(!e.isFunction(a))throw new TypeError;
c=q.call(arguments,2);return d=function(){if(!(this instanceof d))return a.apply(b,c.concat(q.call(arguments)));Da.prototype=a.prototype;var g=new Da;Da.prototype=null;var f=a.apply(g,c.concat(q.call(arguments)));return Object(f)===f?f:g}};e.partial=function(a){var b=q.call(arguments,1);return function(){return a.apply(this,b.concat(q.call(arguments)))}};e.bindAll=function(a){var b=q.call(arguments,1);if(0===b.length)throw Error("bindAll must be passed function names");u(b,function(b){a[b]=e.bind(a[b],
a)});return a};e.memoize=function(a,b){var c={};b||(b=e.identity);return function(){var d=b.apply(this,arguments);return e.has(c,d)?c[d]:c[d]=a.apply(this,arguments)}};e.delay=function(a,b){var c=q.call(arguments,2);return setTimeout(function(){return a.apply(null,c)},b)};e.defer=function(a){return e.delay.apply(e,[a,1].concat(q.call(arguments,1)))};e.throttle=function(a,b,c){var d,g,f,l=null,e=0;c||(c={});var m=function(){e=!1===c.leading?0:new Date;l=null;f=a.apply(d,g)};return function(){var p=
new Date;!e&&!1===c.leading&&(e=p);var h=b-(p-e);d=this;g=arguments;0>=h?(clearTimeout(l),l=null,e=p,f=a.apply(d,g)):!l&&!1!==c.trailing&&(l=setTimeout(m,h));return f}};e.debounce=function(a,b,c){var d,g=null;return function(){var f=this,e=arguments,j=c&&!g;clearTimeout(g);g=setTimeout(function(){g=null;c||(d=a.apply(f,e))},b);j&&(d=a.apply(f,e));return d}};e.once=function(a){var b=!1,c;return function(){if(b)return c;b=!0;c=a.apply(this,arguments);a=null;return c}};e.wrap=function(a,b){return function(){var c=
[a];za.apply(c,arguments);return b.apply(this,c)}};e.compose=function(){var a=arguments;return function(){for(var b=arguments,c=a.length-1;0<=c;c--)b=[a[c].apply(this,b)];return b[0]}};e.after=function(a,b){return function(){if(1>--a)return b.apply(this,arguments)}};e.keys=eb||function(a){if(a!==Object(a))throw new TypeError("Invalid object");var b=[],c;for(c in a)e.has(a,c)&&b.push(c);return b};e.values=function(a){for(var b=e.keys(a),c=b.length,d=Array(c),g=0;g<c;g++)d[g]=a[b[g]];return d};e.pairs=
function(a){for(var b=e.keys(a),c=b.length,d=Array(c),g=0;g<c;g++)d[g]=[b[g],a[b[g]]];return d};e.invert=function(a){for(var b={},c=e.keys(a),d=0,g=c.length;d<g;d++)b[a[c[d]]]=c[d];return b};e.functions=e.methods=function(a){var b=[],c;for(c in a)e.isFunction(a[c])&&b.push(c);return b.sort()};e.extend=function(a){u(q.call(arguments,1),function(b){if(b)for(var c in b)a[c]=b[c]});return a};e.pick=function(a){var b={},c=la.apply(v,q.call(arguments,1));u(c,function(c){c in a&&(b[c]=a[c])});return b};
e.omit=function(a){var b={},c=la.apply(v,q.call(arguments,1)),d;for(d in a)e.contains(c,d)||(b[d]=a[d]);return b};e.defaults=function(a){u(q.call(arguments,1),function(b){if(b)for(var c in b)void 0===a[c]&&(a[c]=b[c])});return a};e.clone=function(a){return!e.isObject(a)?a:e.isArray(a)?a.slice():e.extend({},a)};e.tap=function(a,b){b(a);return a};var Ea=function(a,b,c,d){if(a===b)return 0!==a||1/a==1/b;if(null==a||null==b)return a===b;a instanceof e&&(a=a._wrapped);b instanceof e&&(b=b._wrapped);var g=
Y.call(a);if(g!=Y.call(b))return!1;switch(g){case "[object String]":return a==String(b);case "[object Number]":return a!=+a?b!=+b:0==a?1/a==1/b:a==+b;case "[object Date]":case "[object Boolean]":return+a==+b;case "[object RegExp]":return a.source==b.source&&a.global==b.global&&a.multiline==b.multiline&&a.ignoreCase==b.ignoreCase}if("object"!=typeof a||"object"!=typeof b)return!1;for(var f=c.length;f--;)if(c[f]==a)return d[f]==b;var f=a.constructor,l=b.constructor;if(f!==l&&(!e.isFunction(f)||!(f instanceof
f&&e.isFunction(l)&&l instanceof l)))return!1;c.push(a);d.push(b);f=0;l=!0;if("[object Array]"==g){if(f=a.length,l=f==b.length)for(;f--&&(l=Ea(a[f],b[f],c,d)););}else{for(var j in a)if(e.has(a,j)&&(f++,!(l=e.has(b,j)&&Ea(a[j],b[j],c,d))))break;if(l){for(j in b)if(e.has(b,j)&&!f--)break;l=!f}}c.pop();d.pop();return l};e.isEqual=function(a,b){return Ea(a,b,[],[])};e.isEmpty=function(a){if(null==a)return!0;if(e.isArray(a)||e.isString(a))return 0===a.length;for(var b in a)if(e.has(a,b))return!1;return!0};
e.isElement=function(a){return!!(a&&1===a.nodeType)};e.isArray=db||function(a){return"[object Array]"==Y.call(a)};e.isObject=function(a){return a===Object(a)};u("Arguments Function String Number Date RegExp".split(" "),function(a){e["is"+a]=function(b){return Y.call(b)=="[object "+a+"]"}});e.isArguments(arguments)||(e.isArguments=function(a){return!(!a||!e.has(a,"callee"))});"function"!==typeof/./&&(e.isFunction=function(a){return"function"===typeof a});e.isFinite=function(a){return isFinite(a)&&
!isNaN(parseFloat(a))};e.isNaN=function(a){return e.isNumber(a)&&a!=+a};e.isBoolean=function(a){return!0===a||!1===a||"[object Boolean]"==Y.call(a)};e.isNull=function(a){return null===a};e.isUndefined=function(a){return void 0===a};e.has=function(a,b){return cb.call(a,b)};e.identity=function(a){return a};e.times=function(a,b,c){for(var d=Array(Math.max(0,a)),g=0;g<a;g++)d[g]=b.call(c,g);return d};e.random=function(a,b){null==b&&(b=a,a=0);return a+Math.floor(Math.random()*(b-a+1))};var Z={escape:{"&":"&amp;",
"<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};Z.unescape=e.invert(Z.escape);var fb={escape:RegExp("["+e.keys(Z.escape).join("")+"]","g"),unescape:RegExp("("+e.keys(Z.unescape).join("|")+")","g")};e.each(["escape","unescape"],function(a){e[a]=function(b){return null==b?"":(""+b).replace(fb[a],function(b){return Z[a][b]})}});e.result=function(a,b){if(null!=a){var c=a[b];return e.isFunction(c)?c.call(a):c}};e.mixin=function(a){u(e.functions(a),function(b){var c=e[b]=a[b];e.prototype[b]=function(){var a=
[this._wrapped];za.apply(a,arguments);a=c.apply(e,a);return this._chain?e(a).chain():a}})};var gb=0;e.uniqueId=function(a){var b=++gb+"";return a?a+b:b};e.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Fa=/(.)^/,hb={"'":"'","\\":"\\","\r":"r","\n":"n","\t":"t","\u2028":"u2028","\u2029":"u2029"},ib=/\\|'|\r|\n|\t|\u2028|\u2029/g;e.template=function(a,b,c){var d,c=e.defaults({},c,e.templateSettings),g=RegExp([(c.escape||Fa).source,(c.interpolate||
Fa).source,(c.evaluate||Fa).source].join("|")+"|$","g"),f=0,l="__p+='";a.replace(g,function(b,c,d,g,e){l+=a.slice(f,e).replace(ib,function(a){return"\\"+hb[a]});c&&(l+="'+\n((__t=("+c+"))==null?'':_.escape(__t))+\n'");d&&(l+="'+\n((__t=("+d+"))==null?'':__t)+\n'");g&&(l+="';\n"+g+"\n__p+='");f=e+b.length;return b});l+="';\n";c.variable||(l="with(obj||{}){\n"+l+"}\n");l="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+l+"return __p;\n";try{d=new Function(c.variable||
"obj","_",l)}catch(j){throw j.source=l,j;}if(b)return d(b,e);b=function(a){return d.call(this,a,e)};b.source="function("+(c.variable||"obj")+"){\n"+l+"}";return b};e.chain=function(a){return e(a).chain()};e.mixin(e);u("pop push reverse shift sort splice unshift".split(" "),function(a){var b=v[a];e.prototype[a]=function(){var c=this._wrapped;b.apply(c,arguments);("shift"==a||"splice"==a)&&0===c.length&&delete c[0];return this._chain?e(c).chain():c}});u(["concat","join","slice"],function(a){var b=v[a];
e.prototype[a]=function(){var a=b.apply(this._wrapped,arguments);return this._chain?e(a).chain():a}});e.extend(e.prototype,{chain:function(){this._chain=!0;return this},value:function(){return this._wrapped}});X.module$exports=e;X.module$exports&&(X=X.module$exports);var B={},jb=X,na;if(Object.create)na=function(a){return Object.create(a)};else{var Ga=function(){};na=function(a){Ga.prototype=a;a=new Ga;Ga.prototype=null;return a}}var h=na(jb);h.inherit=na;h.cl=function(){};h.ct=function(){};h.isWindow=
function(a){return null!=a&&a===a.window};h.isNumeric=h.isNumber;h.isPlainObject=function(a){if("object"!==typeof a||a.nodeType||h.isWindow(a))return!1;try{if(a.constructor&&!hasOwn.call(a.constructor.prototype,"isPrototypeOf"))return!1}catch(b){return!1}return!0};h.dictMerge=function(a,b){h.each(b,function(b,d){a[d]=b})};h.arrayMerge=function(a,b,c){var d={},g,f;for(i=0;i<b.length;i++)d[c(b[i])]=i;var e=[];for(i=0;i<a.length;i++)g=a[i],f=c(g),e.push(g),delete d[f];var a=a.length-b.length,j;for(j in d)d.hasOwnProperty(j)&&
(c=d[j],g=b[c],c=Math.max(0,c+a),e.splice(c,0,g),a++);return e};h.mapAll=function(a,b,c){var d=[];if(null==a)return d;var g=0,f;for(f=0;f<a.length;f++){var e=a[f].length;e>g&&(g=e)}for(f=0;f<e;f++){for(var g=[],j=0;j<a.length;j++)g.push(a[j][f]);d.push(b.apply(c,g))}return d};h.stringCompare=function(a,b){for(var c=Math.min(a.length,b.length),d=0;d<c;d++){var g=a.charCodeAt(d),f=b.charCodeAt(d);if(g!=f)return g-f}return b.length-a.length};h.noop=function(){};h.identity=function(a){return a};h.gattr=
function(a){return function(b){return b[a]}};h.unsplat=function(a,b){if(b)return function(){for(var c=[],d=h.toArray(arguments),g=0;g<a;g++)c.push(d.shift());c.push(d);return b.apply(this,c)};b=a;return function(){return b(h.toArray(arguments))}};h.splat=function(a){return function(b){return a.apply(this,b)}};h.dictIsEmpty=h.isEmpty;h.dictIsEqual=h.isEqual;h.truthiness=function(a){switch(a){case 0:case !1:case null:case void 0:return!1;case !0:return!0}if("string"===typeof a)return/[^\s]/.test(a);
if(h.isNumeric(a))return!0;if(void 0!==a.length)return 0<a.length;for(var b in a)if(a.hasOwnProperty(b))return!0;return a.nodeType?!0:!1};h.removeWhitespace=function(a){return a.replace(/\s/g,"")};h.whitespaceEqual=function(a,b){return h.truthiness(a)!==h.truthiness(b)?!1:h.removeWhitespace(a)==h.removeWhitespace(b)};h.future=function(){var a=[],b=[],c=!1,d=!1,g=null,f=function(f,e){d?(c?e:f).apply(g[0],g[1]):(a.push(f),b.push(e))};f.addReader=f;f.fail=function(){if(!d){g=[this,h.toArray(arguments)];
for(c=d=!0;0<b.length;)b.shift().apply(this,arguments)}};f.fire=function(){if(!d){g=[this,h.toArray(arguments)];for(d=!0;0<a.length;)a.shift().apply(this,arguments)}};return f};h.multi=function(a){var b=[],c=[],d=0,g=0,f=!1,e=!1,j=function(){f&&!e&&g>=d&&(e=!0,a(b))},m=function(a,d){b[a]=d;c[a]||(g++,c[a]=!0);j()};return{addValue:function(a){b.push(a);c.push(!0);d++;g++},getCallback:function(){if(f)return h.noop;var a=d;b.push(null);c.push(!1);d++;return h.partial(m,a)},start:function(){f=!0;j()}}};
h.pipe=function(){var a=[],b=[];return{addReader:function(c){var d=b.length;for(b.push(c);0<a.length;)c(a.shift());return d},buffer:a,removeReader:function(a){b[a]=null},write:function(c){if(h.some(b))for(var d=0;d<b.length;d++){var g=b[d];g&&g(c)}else a.push(c)}}};h.maybe_function=function(a){return"function"===typeof a?a:function(){return a}};h.uniqueDebounce=function(a,b){b||(b=100);var c=!1,d=[],g=function(){for(;0<d.length;)a(d.shift());c=!1};return function(f){c?h.contains(d,f)||d.push(f):(a(f),
c=!0,setTimeout(g,b))}};h.reTester=function(a){return function(b){return a.test(b)}};h.hasOnlyKeys=function(a,b){for(var c in a)if(a.hasOwnProperty(c)&&-1==h.indexOf(b,c))return!1;return!0};h.clean=function(a){return h.filter(a,h.truthiness)};var kb=/-([\da-z])/gi,lb=function(a,b){return b.toUpperCase()};h.camelCase=function(a){return a.replace(rmsPrefix,"ms-").replace(kb,lb)};h.replace=function(a,b){for(var c=0;c<a.length;c++){var d=b(a[c]);!1!==d&&(a[c]=d)}};h.indexOf=function(a,b,c,d){d="undefined"==
typeof d?0:d;if(c)for(d;d<a.length;d++){if(c(b,a[d]))return d}else{if(a.indexOf&&0===d)return a.indexOf(b);for(d;d<a.length;d++)if(a[d]==b)return d}return-1};var mb=/(<[^>]*>|[^\w\s]+)/;h.sentenceSplit=function(a){for(var b=a.split(mb),a=[],c=0;c<b.length;c++){var d=b[c];0===c%2?a.push(d):a[a.length-1]+=d}b=0;d=[];for(c=0;c<a.length;c++)d.push(b),b+=a[c].length;return[a,d]};h.logsErrors=function(a){return a};h.throttle=function(a,b,c){var d,g,f,e=null,j=0;c||(c={});var m=function(){j=!1===c.leading?
0:new Date;e=null;f=a.apply(d,g)};return function(){var p=new Date;!j&&!1===c.leading&&(j=p);var h=b-(p-j);d=this;g=arguments;0>=h?(clearTimeout(e),e=null,j=p,f=a.apply(d,g)):!e&&!1!==c.trailing&&(e=setTimeout(m,h));return f}};h.extend=function(){var a,b,c,d,g,f=arguments[0]||{},e=1,j=arguments.length,m=!1;"boolean"===typeof f&&(m=f,f=arguments[1]||{},e=2);"object"!==typeof f&&!h.isFunction(f)&&(f={});for(j===e&&(f=this,--e);e<j;e++)if(null!=(a=arguments[e]))for(b in a)c=f[b],d=a[b],f!==d&&(m&&d&&
(h.isPlainObject(d)||(g=h.isArray(d)))?(g?(g=!1,c=c&&h.isArray(c)?c:[]):c=c&&h.isPlainObject(c)?c:{},f[b]=h.extend(m,c,d)):void 0!==d&&(f[b]=d));return f};B.module$exports=h;B.module$exports&&(B=B.module$exports);var J={},K=B,nb=/\S/;S.uid=1;S.accepts=function(a){try{return a.nodeType?1===a.nodeType||9===a.nodeType:!0}catch(b){}};S.prototype={acceptData:function(a){return a.nodeType?1===a.nodeType||9===a.nodeType:!0},key:function(a){if(!S.accepts(a))return 0;var b={},c=a[this.expando];if(!c){c=S.uid++;
try{b[this.expando]={value:c},Object.defineProperties(a,b)}catch(d){b[this.expando]=c,K.extend(a,b)}}this.cache[c]||(this.cache[c]={});return c},set:function(a,b,c){var d,a=this.key(a),g=this.cache[a];if("string"===typeof b)g[b]=c;else if(K.isEmptyObject(g))K.extend(this.cache[a],b);else for(d in b)g[d]=b[d];return g},get:function(a,b){var c=this.cache[this.key(a)];return void 0===b?c:c[b]},access:function(a,b,c){if(void 0===b||b&&"string"===typeof b&&void 0===c)return c=this.get(a,b),void 0!==c?
c:this.get(a,K.camelCase(b));this.set(a,b,c);return void 0!==c?c:b},remove:function(a,b){var c,d;c=this.key(a);var g=this.cache[c];if(void 0===b)this.cache[c]={};else{K.isArray(b)?d=b.concat(b.map(K.camelCase)):(c=K.camelCase(b),b in g?d=[b,c]:(d=c,d=d in g?[d]:d.match(nb)||[]));for(c=d.length;c--;)delete g[d[c]]}},hasData:function(a){return!K.isEmptyObject(this.cache[a[this.expando]]||{})},discard:function(a){a[this.expando]&&delete this.cache[a[this.expando]]}};J.module$exports=new S;J.module$exports&&
(J=J.module$exports);var aa={},ob={" ":!0,"\t":!0,"\n":!0,"\f":!0,"\r":!0},z;z={defaultJunkFunction:function(a){return ob.hasOwnProperty(a)},stripLinebreaks:function(a){return a.replace(/^[\n\r]*|[\n\r]*$/g,"")},stringAsLines:function(a){for(var b=a.indexOf("\n"),c=a.indexOf("\r"),a=a.split(-1<b&&-1<c||0>c?"\n":"\r"),b=0;b<a.length;b++)a[b]=z.stripLinebreaks(a[b]);return a},__reduce:function(a,b,c){if(null!=c)var d=0;else if(b)c=b[0],d=1;else return null;for(;d<b.length;d++)c=a(c,b[d]);return c},
__ntuplecomp:function(a,b){for(var c=Math.max(a.length,b.length),d=0;d<c;d++){if(a[d]<b[d])return-1;if(a[d]>b[d])return 1}return a.length==b.length?0:a.length<b.length?-1:1},__calculate_ratio:function(a,b){return b?2*a/b:1},__isindict:function(a){return function(b){return a.hasOwnProperty(b)}},__dictget:function(a,b,c){return a.hasOwnProperty(b)?a[b]:c},SequenceMatcher:function(a,b,c){this.set_seqs=function(a,b){this.set_seq1(a);this.set_seq2(b)};this.set_seq1=function(a){a!=this.a&&(this.a=a,this.matching_blocks=
this.opcodes=null)};this.set_seq2=function(a){a!=this.b&&(this.b=a,this.matching_blocks=this.opcodes=this.fullbcount=null,this.__chain_b())};this.__chain_b=function(){for(var a=this.b,b=a.length,c=this.b2j={},e={},j=0;j<a.length;j++){var m=a[j];if(c.hasOwnProperty(m)){var p=c[m];200<=b&&100*p.length>b?(e[m]=1,delete c[m]):p.push(j)}else c[m]=[j]}for(m in e)e.hasOwnProperty(m)&&delete c[m];a=this.isjunk;b={};if(a){for(m in e)e.hasOwnProperty(m)&&a(m)&&(b[m]=1,delete e[m]);for(m in c)c.hasOwnProperty(m)&&
a(m)&&(b[m]=1,delete c[m])}this.isbjunk=z.__isindict(b);this.isbpopular=z.__isindict(e)};this.find_longest_match=function(a,b,c,e){for(var j=this.a,m=this.b,p=this.b2j,h=this.isbjunk,n=a,r=c,t=0,F=null,q={},u=[],oa=a;oa<b;oa++){var s={},v=z.__dictget(p,j[oa],u),w;for(w in v)if(v.hasOwnProperty(w)&&(F=v[w],!(F<c))){if(F>=e)break;s[F]=k=z.__dictget(q,F-1,0)+1;k>t&&(n=oa-k+1,r=F-k+1,t=k)}q=s}for(;n>a&&r>c&&!h(m[r-1])&&j[n-1]==m[r-1];)n--,r--,t++;for(;n+t<b&&r+t<e&&!h(m[r+t])&&j[n+t]==m[r+t];)t++;for(;n>
a&&r>c&&h(m[r-1])&&j[n-1]==m[r-1];)n--,r--,t++;for(;n+t<b&&r+t<e&&h(m[r+t])&&j[n+t]==m[r+t];)t++;return[n,r,t]};this.get_matching_blocks=function(){if(null!=this.matching_blocks)return this.matching_blocks;for(var a=this.a.length,b=this.b.length,c=[[0,a,0,b]],e=[],j,m,p,h,n,r,t,F;c.length;)if(h=c.pop(),j=h[0],m=h[1],p=h[2],h=h[3],F=this.find_longest_match(j,m,p,h),n=F[0],r=F[1],t=F[2])e.push(F),j<n&&p<r&&c.push([j,n,p,r]),n+t<m&&r+t<h&&c.push([n+t,m,r+t,h]);e.sort(z.__ntuplecomp);c=j1=k1=block=0;
j=[];for(var q in e)e.hasOwnProperty(q)&&(block=e[q],i2=block[0],j2=block[1],k2=block[2],c+k1==i2&&j1+k1==j2?k1+=k2:(k1&&j.push([c,j1,k1]),c=i2,j1=j2,k1=k2));k1&&j.push([c,j1,k1]);j.push([a,b,0]);return this.matching_blocks=j};this.get_opcodes=function(){if(null!=this.opcodes)return this.opcodes;var a=0,b=0,c=[];this.opcodes=c;var e,j,m,p,h=this.get_matching_blocks(),n;for(n in h)h.hasOwnProperty(n)&&(e=h[n],j=e[0],m=e[1],e=e[2],p="",a<j&&b<m?p="replace":a<j?p="delete":b<m&&(p="insert"),p&&c.push([p,
a,j,b,m]),a=j+e,b=m+e,e&&c.push(["equal",j,a,m,b]));return c};this.get_grouped_opcodes=function(a){a||(a=3);var b=this.get_opcodes();b||(b=[["equal",0,1,0,1]]);var c,e,j,m,p;"equal"==b[0][0]&&(c=b[0],e=c[0],j=c[1],m=c[2],p=c[3],c=c[4],b[0]=[e,Math.max(j,m-a),m,Math.max(p,c-a),c]);"equal"==b[b.length-1][0]&&(c=b[b.length-1],e=c[0],j=c[1],m=c[2],p=c[3],c=c[4],b[b.length-1]=[e,j,Math.min(m,j+a),p,Math.min(c,p+a)]);var h=a+a,n=[],r;for(r in b)b.hasOwnProperty(r)&&(c=b[r],e=c[0],j=c[1],m=c[2],p=c[3],c=
c[4],"equal"==e&&m-j>h&&(n.push([e,j,Math.min(m,j+a),p,Math.min(c,p+a)]),j=Math.max(j,m-a),p=Math.max(p,c-a)),n.push([e,j,m,p,c]));n&&"equal"==n[n.length-1][0]&&n.pop();return n};this.ratio=function(){matches=z.__reduce(function(a,b){return a+b[b.length-1]},this.get_matching_blocks(),0);return z.__calculate_ratio(matches,this.a.length+this.b.length)};this.quick_ratio=function(){var a,b;if(null==this.fullbcount){this.fullbcount=a={};for(var c=0;c<this.b.length;c++)b=this.b[c],a[b]=z.__dictget(a,b,
0)+1}a=this.fullbcount;for(var e={},j=z.__isindict(e),m=numb=0,c=0;c<this.a.length;c++)b=this.a[c],numb=j(b)?e[b]:z.__dictget(a,b,0),e[b]=numb-1,0<numb&&m++;return z.__calculate_ratio(m,this.a.length+this.b.length)};this.real_quick_ratio=function(){var a=this.a.length,b=this.b.length;return _calculate_ratio(Math.min(a,b),a+b)};this.isjunk=c?c:z.defaultJunkFunction;this.a=this.b=null;this.set_seqs(a,b)}};aa.module$exports=z;aa.module$exports&&(aa=aa.module$exports);var L={},D=B,pa=J,pb=Q,w={traverse:function(a,
b){if(a){a.nodeType==Node.ELEMENT_NODE&&b(a);for(var c=w.getChildNodes(a),d=0;d<c.length;d++)c[d].nodeType==Node.ELEMENT_NODE&&w.traverse(c[d],b)}},nodeCompare:function(a,b){return a==b?!0:a.nodeType!=b.nodeType?!1:a.nodeType==Node.TEXT_NODE?a.data==b.data:!1},stringifyNode:function(a){return a.nodeType==Node.TEXT_NODE?"t:"+a.data:a.nodeType==Node.ELEMENT_NODE?w.get_node_id(a):""},nodeParentIndex:function(a){var b=a.parentNode,a=D.indexOf(w.getChildNodes(b),a);return[b,a]},elementParentIndex:function(a){var b=
a.parentNode,c=w.getChildNodes(b),a=D.indexOf(D.filter(c,w.isElement),a);return[b,a]},isElement:function(a){return a.nodeType==Node.ELEMENT_NODE},isTextNode:function(a){return!!(a&&a.nodeType===Node.TEXT_NODE)},iterAttributes:function(a,b){for(var c=0;c<a.attributes.length;c++)b(c.name,c.value)},updateAttributes:function(a,b,c){var d=[];w.iterAttributes(a,function(c,e){b[c]?b[c]!=e&&a.setAttribute(c,e):a.removeAttribute(c);d.push(c)});D.each(b,function(b,c){a.setAttribute(c,b)});D.each(c,function(b,
c){a.removeAttribute(c)})},removeAllAttributes:function(a){var b=[];w.iterAttributes(a,function(a){b.push(a)});D.each(b,function(b){a.removeAttribute(b)})},setAttributes:function(a,b){D.each(b,function(b,d){a.setAttribute(d,b)})},setIdClass:function(a,b){var c=a.getAttribute("class");c?(c=D.filter(c.split(/\s+/g),function(a){return!/^dynajot-/.test(a)}),res=c.join(" ")):c=[];c.push("dynajot-"+b);a.setAttribute("class",c.join(" "))},toFragment:function(a){var b=document.createDocumentFragment(),c;
for(c=0;c<a.length;c++)b.appendChild(a[c]);return b},getChildNodes:function(a){return a?D.toArray(a.childNodes):[]},removeAllChildren:function(a){for(;a.firstChild;)a.removeChild(a.firstChild)},mergeChildren:function(a,b){w.removeAllChildren(a);var c=w.toFragment(b);a.appendChild(c)},spliceNodes:function(a,b,c,d){for(var e=D.filter(w.getChildNodes(a),function(a){return-1===D.indexOf(d,a)}),f=w.toFragment(d);b<Math.min(c,e.length);b++)e[b]&&a.removeChild(e[b]);(c=e[c])?a.insertBefore(f,c):a.appendChild(f)},
yankNode:function(a){a.parentNode&&a.parentNode.removeChild(a)},insertNodeAt:function(a,b,c){if(c=a.childNodes[c])if(c.nodeType==Node.ELEMENT_NODE)a.insertBefore(b,c);else{var d=document.createDocumentFragment();for(d.appendChild(b);c&&c.nodeType!=Node.ELEMENT_NODE;)b=c.nextSibling,a.removeChild(c),d.appendChild(c),c=b;c?a.insertBefore(d,c):a.appendChild(d)}else a.appendChild(b)},isChildOf:function(a,b){for(var c=b;c&&c!=document;){if(c.parentNode==a)return!0;c=c.parentNode}return!1},getNodeById:function(a){var b=
pa.get(a,"node_id");if(b)return b;a=a.getAttribute("class");if(!a)return null;a=D.filter(a.split(),D.reTester(/^dynajot-.*/));return 0<a.length?a[0]:null},set_node_id:function(a,b){pa.set(a,"node_id",b);w.setIdClass(a,b)},assign_node_id:function(a,b,c){if(b==a)return"_root";if(a=pa.get(b,"node_id"))return a;c=pb.node_id(c);w.set_node_id(b,c);return c},assign_all_ids:function(a,b,c){w.traverse(b,function(b){w.assign_node_id(a,b,c)})},get_node_id:function(a){return pa.get(a,"node_id")}};L.module$exports=
w;L.module$exports&&(L=L.module$exports);var ba={},qb=B,G={id:"dj-cursor-stable",user:{},send_fn:null},rb={generateUUID:function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)})}},ra={createCursor:function(a){var a=['<div id="dj-presence-mouse-'+a.id+'" class="dj-mouse">','<div class="dj-filler-wrap">','<div class="dj-filler">'+a.name+"</div>","</div></div>"].join(""),b=$("div");b.html(a);$("#"+G.id).append(b);
return b},getOrCreateCursor:function(a){($cursor=qa[a.id])||($cursor=ra.createCursor(a),qa[a.id]=$cursor);return $cursor}},qa={};G.init=function(a){G.send_fn=a;a=document.createElement("div");a.id=G.id;a.css="position: absolute; top:0; left:0;";document.body.appendChild(a);a=prompt("What is your name?");G.user={name:a,id:rb.generateUUID()};G.send_fn({kind:"mouse_position",value:{mouse_position:{enter:!0},user:G.user}});$("body").on("mousemove",qb.throttle(function(a){G.send_fn({kind:"mouse_position",
value:{mouse_position:{mousemove:{coords:[a.pageX,a.pageY]}},user:{name:G.user.name,id:G.user.id}}})},75))};G.updateCursors=function(a){var a=JSON.parse(a.data),b,c,d;"mouse_position"===a.kind&&(a=a.value,a.action.enter&&(c=ra.createCursor(a.user),qa[a.user.id]=c),a.action.leave&&(ra.removeUserCursor(a.user),delete qa[a.user.id]),a.action.mousemove&&(b=a.action.mousemove.coords,c=b[0],b=b[1],d=ra.getOrCreateCursor(a.user),d.css({top:b,left:c}),d.find(".dj-filler").text(a.user.name)))};ba.module$exports=
G;ba.module$exports&&(ba=ba.module$exports);var ca={},sa=L,sb=B;ca.module$exports={throttledPoll:function(){},onChange:function(a,b,c){var d=sb.uniqueDebounce(b,c),e=function(b){sa.isChildOf(b,a)||d(b)};"undefined"!==typeof MutationObserver?(new MutationObserver(function(a){for(var b=0;b<a.length;b++)sa.traverse(a[b].target,e)})).observe(a,{childList:!0,attributes:!0,characterData:!0,subtree:!0}):a.addEventListener("DOMSubtreeModified",function(b){sa.traverse(b.target||a,e)});setInterval(function(){sa.traverse(a,
b)},500)}};ca.module$exports&&(ca=ca.module$exports);var R={},x=B,H=J,I=L,tb=aa,ub=ca,y={},vb={onclick:!0,ondblclick:!0,onmousedown:!0,onmouseup:!0,onmouseover:!0,onmousemove:!0,onmouseout:!0,ondragstart:!0,ondrag:!0,ondragenter:!0,ondragleave:!0,ondragover:!0,ondrop:!0,ondragend:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onload:!0,onunload:!0,onabort:!0,onerror:!0,onresize:!0,onscroll:!0,onselect:!0,onchange:!0,onsubmit:!0,onreset:!0,onfocus:!0,onblur:!0};y.serializeNode=function(a,b,c){if(!b||!b.parentNode)return{};
var d={};if(I.isTextNode(b))return y.serializeNode(a,b.parent,c);d.attrs={};if(b.hasAttributes())for(var e=0;e<b.attributes.length;e++){var f=b.attributes[e].name,l=b.attributes[e].value;if(!vb.hasOwnProperty(f.toLowerCase())&&!("class"==f&&(l=l.replace(/dynajot-[^\s]*/g,""),l=l.replace(/\s+/g," "),l=l.trim(),0===l.length)))d.attrs[f]=l}d.name=b.tagName.toLowerCase();d.children=x.map(I.getChildNodes(b),function(b){return I.isTextNode(b)?{kind:"text",value:b.data}:{kind:"id",value:I.assign_node_id(a,
b,c)}});d.position=b==a?null:{parent:I.assign_node_id(a,b.parentNode,c),index:I.nodeParentIndex(b)[1]};d.id=I.assign_node_id(a,b,c);return d};y.updateState=function(a,b,c){if(!I.isTextNode(b)){var d=b.getAttribute("data-id");d&&(I.set_node_id(b,d),b.removeAttribute("data-id"));a=y.serializeNode(a,b,c);H.set(b,"state",a);return a}};y.mergeDeltas=function(a,b){b.attrs&&(a.attrs||(a.attrs={}),x.dictMerge(a.attrs,b.attrs));b.position&&(a.position=x.inherit(b.position));b.message_id&&(a.message_id=b.message_id);
b.children&&(a.children&&0<a.children.length?Array.prototype.push.apply(a.children,b.children):a.children=b.children)};y.sentenceDiff=function(a,b){for(var c=x.sentenceSplit(a),d=x.sentenceSplit(b),e=c[1],d=d[0],c=(new tb.SequenceMatcher(c[0],d)).get_opcodes(),f=[],l=0;l<c.length;l++){var j=c[1],m=c[2],h=c[3],n=c[4];switch(c[0]){case "replace":f.push({action:"replace",start:e[j],end:e[m],value:d.slice(h,n).join("")});break;case "delete":f.push({action:"delete",start:e[j],end:e[m],value:null});break;
case "insert":f.push({action:"insert",start:e[j],end:e[m],valie:d.slice(h,n).join("")})}}return f};y.patch=function(a,b){var c=a,d=0;b.sort(function(a,b){return a.start-b.start});for(var e=0;e<b.length;e++){var f=b[e];switch(f.action){case "replace":c=c.slice(0,d+f.start)+f.value+c.slice(d+f.end);d+=f.end-f.start+f.value.length;break;case "delete":c=c.slice(0,d+f.start)+c.slice(d+f.end);d-=f.end-f.start;break;case "insert":c=c.slice(0,d+f.start)+f.value+a.slice(d+f.start),d+=f.value.length}}return c};
y.delta=function(a,b){var c=x.clone(b);c.removed_children=x.filter(a.children,function(a){return-1==x.indexOf(b.children,a,x.isEqual)});c.removed_attrs={};x.each(a.attrs,function(a,e){e in b.attrs||(c.removed_attrs[e]=a)});return c};y.nodeTransactions=function(a,b,c){x.each(b,function(a){H.set(a,"dirty",!0)});c();x.each(b,function(b){y.updateState(a,b);H.set(b,"dirty",!1)})};y.nodeTransaction=function(a,b,c){b.parentNode?(H.set(b,"dirty",!0),c(H.get(b,"state"),b),y.updateState(a,b),H.set(b,"dirty",
!1)):c({},b)};y.changes=function(a,b,c){var d=function(e){if(I.isTextNode(e)&&(e=e.parentNode),e)if(H.get(e,"dirty"))setTimeout(x.partial(d,e),200);else{H.get(e,"seen");var f=H.get(e,"state"),l=y.serializeNode(a,e,b);x.truthiness(l)&&(f?!x.isEmpty(l)&&!x.isEqual(f,l)&&c(y.delta(f,l)):c(l),H.set(e,"state",l),H.set(e,"seen",!0))}};ub.onChange(a,d,200)};R.module$exports=y;R.module$exports&&(R=R.module$exports);var ta={},A=B,n={t:{}};n.t.array=A.isArray;n.t.element=A.isElement;n.t.fn=A.isFunction;n.t.string=
A.isString;n.t.number=A.isNumber;n.t.bool=A.isBoolean;n.t.dict=A.isObject;n.t.any=function(a){return function(b){return A.every(b,A.partial(n.validate,a))}};n.t.nullable=function(a){return function(b){return null===b?!0:n.validate(a,b)}};n.errback=function(){console.trace()};n.validate=function(a,b){if(a==b)return!0;if("function"==typeof a)return a(b);if(typeof a!=typeof b||A.isArray(a)!=A.isArray(b)||A.isObject(a)!=A.isObject(b))return!1;var c=!0;A.each(b,function(b,e){var f=a[e];if(!f||!n.validate(f,
b))return c=!1});if(!c)return c;A.each(a,function(a,e){if(!(e in b))return c=!1});return c};n.inp_validated=function(a,b,c){c||(c=n.errback);return function(d){n.validate(a,d)||c(b,a,d);return b(d)}};n.outp_validated=function(a,b,c){c||(c=n.errback);return function(){var d=b.apply(this,arguments);n.validate(a,d)||c(b,a,d);return d}};n.Delta={id:n.t.string,name:n.t.string,message_id:n.t.nullable([n.t.string,n.t.number,n.t.string,n.t.number]),attrs:{"+":n.t.dict,"-":n.t.dict},position:n.t.nullable({parent:n.t.string,
offset:n.t.number}),children:n.t.any({kind:n.t.string,value:n.t.string})};n.Element={id:n.t.string,attrs:n.t.dict,position:{parent:n.t.string,index:n.t.number},children:n.t.any({kind:n.t.string,value:n.t.string})};ta.module$exports=n;ta.module$exports&&(ta=ta.module$exports);var da={},M=B,N=L,wb=R,ua=J,C={},Wa={};C.getNode=function(a,b){var c;(c="_root"===b?a:a.querySelector(".dynajot-"+b))?Wa[b]=c:c=Wa[b]||null;return c};C.resolveNode=function(a,b){return"text"==b.kind?document.createTextNode(b.value):
C.getNode(a,b.value)};C.insertionIndex=function(a,b){var c=ua.get(a,"children_resolved");if(!c)return b;for(var d=0,e=0;e<b;e++)c[e]||d++;return b-d};C.insertChildNodeAt=function(a,b,c){var d=ua.get(a,"children_resolved"),e=d?C.insertionIndex(a,c):c;N.insertNodeAt(a,b,e);d&&(d[c]=!0,ua.set(a,"children_resolved",d))};C.appliesDeltas=function(a,b){var c,d={},e=function(a,b){c(b);for(var e=d[a];e&&0<e.length;)e.shift()(b);delete d[a]},f=M.partial(C.resolveNode,a);return c=function(c){var j=C.getNode(a,
c.id),m=function(b){var d=function(a,b,c){var c=c||[],b=M.map(b,f),d=M.map(b,M.truthiness);ua.set(a,"children_resolved",d);return N.mergeChildren(a,M.clean(b),c)},e=[];j&&e.push(j);b&&e.push(b);wb.nodeTransactions(a,e,function(){if(j){M.cl("existing");if(b&&b!=a){var e=N.get_node_id(j.parentNode),f=N.nodeParentIndex(j)[1];if(c.position.parent!=e||c.position.index!=f)N.yankNode(j),C.insertChildNodeAt(b,j,c.position.index)}c.attrs&&N.updateAttributes(j,c.attrs,c.removed_attrs);c.children&&d(j,c.children,
c.removed_children)}else M.cl("new",c.id,C.getNode(a,c.id)),e=document.createElement(c.name),c.attrs&&N.updateAttributes(e,c.attrs),c.children&&d(e,c.children),N.set_node_id(e,c.id),C.insertChildNodeAt(b,e,c.position.index)})};if(c.position){var h=c.position.parent,n=C.getNode(a,h);n?m(n):d[h]?d[h].push(m):(b(h,M.partial(e,h)),d[h]=[m])}else m(null)}};da.module$exports=C;da.module$exports&&(da=da.module$exports);var ea={},Ha=W,O=B,Xa={},Ya=function(a){var b=50;return function(){setTimeout(a,b);1E3>
b&&(b*=2)}};if(window.WebSocket)Xa.connect=function(a){var a=O.maybe_function(a),b,c=O.pipe(),d=O.future(),e=[],f=!1,l=!1,j,m;j=function(){b=new WebSocket(a());b.onopen=function(){var a=l;for(l=!0;0<e.length&&1===b.readyState;)b.send(JSON.stringify(e.shift()));a||d.fire()};b.onerror=function(){1!==b.readyState&&(b.close(),m())};b.onmessage=function(a){a=JSON.parse(a.data);O.isArray(a)?O.each(c.write,a):c.write(a)};b.onclose=function(){l=!1;f||m()}};m=Ya(j);j();return{send:function(a){var c=JSON.stringify(a);
if(f)return!1;for(;;){if(l&&1===b.readyState)try{b.send(c);break}catch(d){}e.push(a);break}},onOpen:d,removeOpenCallback:d.remove,onMessage:c.addReader,removeMessageCallback:c.removeReader,close:function(){f=!0;b.close()}}};else{var va;a:{for(;;){var Za=Ha.random_string(10);if(!(Za in window)){va=Za;break a}}va=void 0}var T=null,$a=!1,U=[];window[va]=function(a){if("load"==a)for($a=!0;0<U.length;)U.shift()(T);else U[a.webSocketId](a)};Ha.onReady(function(){T=Ha.create("/WebSocketMainInsecure.swf",
{},{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always",flashVars:"callbackName=window."+va})});soket.connect=function(a){var a=O.maybe_function(a),b=U.length,c=O.pipe(),d=O.future(),e=[],f=!1,l=!1,j=function(){var c=function(c){c.create(b,a(),[])};$a?c(T):U.push(c)},m=Ya(j);U.push(function(a){switch(a.type){case "message":a=decodeURIComponent(a.message);c.write(JSON.parse(a));break;case "close":f||m();break;case "open":for(l=!0;0<e.length;)T.send(b,JSON.stringify(e.shift()));d.fire()}});j();
return{send:function(a){if(f)return!1;l?T.send(b,JSON.stringify(a)):e.push(a)},onOpen:d,removeOpenCallback:d.remove,onMessage:c.addReader,removeMessageCallback:c.removeReader,close:function(){f=!0;l&&T.close(b)}}}}ea.module$exports=Xa;ea.module$exports&&(ea=ea.module$exports);var fa={},xb=Q,V=B,yb=R;fa.module$exports={make:function(a){var b=[],c={_locals:{}};c._locals.sequence=b;var d=function(a,b){var c=a.message_id,d=b.message_id;return c[1]!=d[1]?c[1]-d[1]:c[2]!=d[2]?V.stringCompare(c[2],d[2]):
c[3]-d[3]};c._locals.compareDeltas=d;var e=function(a){if(0===b.length)return 0;if(1===b.length)return 0<d(a,b[0])?1:0;var c=0,e=b.length;if(0<=d(a,b[e-1]))return e;for(;e>c&&0<=c;){var f=c+Math.round((e-c)/2),g=d(a,b[f]);if(0===g)return f;if(f>=e)return e;0<g?c=f:e=f}return c};c._locals.insertionPoint=e;var f=function(a){var a=V.groupBy(a,V.gattr("id")),b={},c;for(c in a)if(a.hasOwnProperty(c)){for(var d=a[c],e=V.inherit(d[0]),f=1;f<d.length;f++)yb.mergeDeltas(e,d[f]);b[c]=e}return V.values(b)};
c._locals.mergeDeltas=f;c.addDelta=function(c){c=V.inherit(c);c.message_id||(c.message_id=xb.message_id(a));var d=e(c);b.splice(d,0,c);return b.slice(d)};c.changeset=function(a){a=c.addDelta(a);return f(a)};return c}};fa.module$exports&&(fa=fa.module$exports);var ga={},E=B,zb=ea,wa=R,Ab=da,P=L,Bb=fa,ab=ba,Ia=Q,Cb=J,bb={DEVELOP_MODE:!1,sync:function(a,b){var b=b||{},c=b.document_id,d=window.location.hash.slice(1).trim();!c&&E.truthiness(d)&&(c=d);var e="ws://damp-cove-5558.herokuapp.com/doc/";bb.DEVELOP_MODE&&
(e="ws://localhost:5000/doc");var f,h=zb.connect(function(){return c?e+c:e}),d={document_id:E.pipe(),document_state:E.pipe(),message:E.pipe(),response:E.pipe()},j=0,m={};d.response.addReader(function(a){var b=a.id;m[b](a.value);delete m[b]});var n=function(a,b){var c=j;j++;m[c]=function(c){"error"==c.kind&&404==c.value&&setTimeout(E.partial(n,a,b),500)};h.send({kind:"request",value:{resource:"/nodes/"+a,id:c}})},q={delta:E.pipe(),mouse_position:E.pipe()},s=function(a){return function(b){a[b.kind]&&
a[b.kind].write(b.value)}};h.onMessage(s(d));d.message.addReader(s(q));d.message.addReader(function(a){a.global_timestamp&&Ia.global_timestamp(c,a.global_timestamp)});d.document_id.addReader(function(a){var b=c;c=a;a.global_timestamp&&Ia.global_timestamp(c,a.global_timestamp);"function"===typeof b?b(c):window.location.hash=c});b.cursors&&(ab.init(h.send),q.mouse_position.addReader(ab.updateCursors));d.document_state.addReader(E.once(function(b){f=Bb.make(c);if(b){var d=document.createElement("div");
d.innerHTML=b;b=d.firstChild;for(P.removeAllChildren(a);;){d=b.firstChild;if(!d)break;b.removeChild(d);a.appendChild(d)}P.removeAllAttributes(a);P.iterAttributes(b,function(b,c){a.setAttribute(b,c)});P.traverse(a,function(b){var d=b.getAttribute("data-id");d&&(P.set_node_id(b,d),b.removeAttribute("data-id"),wa.updateState(a,b,c),Cb.set(b,"seen",!0))})}else P.traverse(a,function(b){P.isTextNode(b)||(b=wa.serializeNode(a,b,c),f.addDelta(b),h.send({kind:"delta",value:b}))});P.traverse(a,function(b){wa.updateState(a,
b,c)});var e={},g=function(a){return E.map(a,function(a){return a.toString()}).join("-")},j=Ab.appliesDeltas(a,n);q.delta.addReader(function(a){var b=g(a.message_id);e[b]||(e[b]=!0,a=f.changeset(a),E.each(a,j))});wa.changes(a,c,function(a){E.isEmpty(a)||(a=E.clone(a),a.message_id=Ia.message_id(c),e[g(a.message_id)]=!0,f.addDelta(a),h.send({kind:"delta",value:a}))})}))}};ga.module$exports=bb;ga.module$exports&&(ga=ga.module$exports);window.dynajot=ga})();
