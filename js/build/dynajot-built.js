/** @license
 *  Underscore.js 1.5.1
     http://underscorejs.org
     (c) 2009-2013 Jeremy Ashkenas, DocumentCloud and Investigative Reporters & Editors
     Underscore may be freely distributed under the MIT license.
*/

/** @license jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license */

/** @license
This is part of jsdifflib v1.0. <http://snowtide.com/jsdifflib>

Copyright (c) 2007, Snowtide Informatics Systems, Inc.
All rights reserved.

Redistribution and use in source and binary forms, with or without modification,
are permitted provided that the following conditions are met:

	* Redistributions of source code must retain the above copyright notice, this
		list of conditions and the following disclaimer.
	* Redistributions in binary form must reproduce the above copyright notice,
		this list of conditions and the following disclaimer in the documentation
		and/or other materials provided with the distribution.
	* Neither the name of the Snowtide Informatics Systems nor the names of its
		contributors may be used to endorse or promote products derived from this
		software without specific prior written permission.

THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND ANY
EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES
OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE DISCLAIMED. IN NO EVENT
SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR ANY DIRECT, INDIRECT,
INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES (INCLUDING, BUT NOT LIMITED
TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES; LOSS OF USE, DATA, OR PROFITS; OR
BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN
CONTRACT, STRICT LIABILITY, OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN
ANY WAY OUT OF THE USE OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH
DAMAGE.
***/

define("underscore",[],function(){var e={},t=Array.prototype,n=Object.prototype,r=Function.prototype,i=t.push,s=t.slice,o=t.concat,u=n.toString,a=n.hasOwnProperty,f=t.forEach,l=t.map,c=t.reduce,h=t.reduceRight,p=t.filter,d=t.every,v=t.some,m=t.indexOf,g=t.lastIndexOf,y=Array.isArray,b=Object.keys,w=r.bind,E=function(e){if(e instanceof E)return e;if(!(this instanceof E))return new E(e);this._wrapped=e};E.VERSION="1.5.1 (hacked for requirejs)";var S=E.each=E.forEach=function(t,n,r){if(t==null)return;if(f&&t.forEach===f)t.forEach(n,r);else if(t.length===+t.length){for(var i=0,s=t.length;i<s;i++)if(n.call(r,t[i],i,t)===e)return}else{var o=E.keys(t);for(var i=0,s=o.length;i<s;i++)if(n.call(r,t[o[i]],o[i],t)===e)return}};E.map=E.collect=function(e,t,n){var r=[];return e==null?r:l&&e.map===l?e.map(t,n):(S(e,function(e,i,s){r.push(t.call(n,e,i,s))}),r)};var x="Reduce of empty array with no initial value";E.reduce=E.foldl=E.inject=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(c&&e.reduce===c)return r&&(t=E.bind(t,r)),i?e.reduce(t,n):e.reduce(t);S(e,function(e,s,o){i?n=t.call(r,n,e,s,o):(n=e,i=!0)});if(!i)throw new TypeError(x);return n},E.reduceRight=E.foldr=function(e,t,n,r){var i=arguments.length>2;e==null&&(e=[]);if(h&&e.reduceRight===h)return r&&(t=E.bind(t,r)),i?e.reduceRight(t,n):e.reduceRight(t);var s=e.length;if(s!==+s){var o=E.keys(e);s=o.length}S(e,function(u,a,f){a=o?o[--s]:--s,i?n=t.call(r,n,e[a],a,f):(n=e[a],i=!0)});if(!i)throw new TypeError(x);return n},E.find=E.detect=function(e,t,n){var r;return T(e,function(e,i,s){if(t.call(n,e,i,s))return r=e,!0}),r},E.filter=E.select=function(e,t,n){var r=[];return e==null?r:p&&e.filter===p?e.filter(t,n):(S(e,function(e,i,s){t.call(n,e,i,s)&&r.push(e)}),r)},E.reject=function(e,t,n){return E.filter(e,function(e,r,i){return!t.call(n,e,r,i)},n)},E.every=E.all=function(t,n,r){n||(n=E.identity);var i=!0;return t==null?i:d&&t.every===d?t.every(n,r):(S(t,function(t,s,o){if(!(i=i&&n.call(r,t,s,o)))return e}),!!i)};var T=E.some=E.any=function(t,n,r){n||(n=E.identity);var i=!1;return t==null?i:v&&t.some===v?t.some(n,r):(S(t,function(t,s,o){if(i||(i=n.call(r,t,s,o)))return e}),!!i)};E.contains=E.include=function(e,t){return e==null?!1:m&&e.indexOf===m?e.indexOf(t)!=-1:T(e,function(e){return e===t})},E.invoke=function(e,t){var n=s.call(arguments,2),r=E.isFunction(t);return E.map(e,function(e){return(r?t:e[t]).apply(e,n)})},E.pluck=function(e,t){return E.map(e,function(e){return e[t]})},E.where=function(e,t,n){return E.isEmpty(t)?n?void 0:[]:E[n?"find":"filter"](e,function(e){for(var n in t)if(t[n]!==e[n])return!1;return!0})},E.findWhere=function(e,t){return E.where(e,t,!0)},E.max=function(e,t,n){if(!t&&E.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.max.apply(Math,e);if(!t&&E.isEmpty(e))return-Infinity;var r={computed:-Infinity,value:-Infinity};return S(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o>r.computed&&(r={value:e,computed:o})}),r.value},E.min=function(e,t,n){if(!t&&E.isArray(e)&&e[0]===+e[0]&&e.length<65535)return Math.min.apply(Math,e);if(!t&&E.isEmpty(e))return Infinity;var r={computed:Infinity,value:Infinity};return S(e,function(e,i,s){var o=t?t.call(n,e,i,s):e;o<r.computed&&(r={value:e,computed:o})}),r.value},E.shuffle=function(e){var t,n=0,r=[];return S(e,function(e){t=E.random(n++),r[n-1]=r[t],r[t]=e}),r};var N=function(e){return E.isFunction(e)?e:function(t){return t[e]}};E.sortBy=function(e,t,n){var r=N(t);return E.pluck(E.map(e,function(e,t,i){return{value:e,index:t,criteria:r.call(n,e,t,i)}}).sort(function(e,t){var n=e.criteria,r=t.criteria;if(n!==r){if(n>r||n===void 0)return 1;if(n<r||r===void 0)return-1}return e.index-t.index}),"value")};var C=function(e){return function(t,n,r){var i={},s=n==null?E.identity:N(n);return S(t,function(n,o){var u=s.call(r,n,o,t);e(i,u,n)}),i}};E.groupBy=C(function(e,t,n){(E.has(e,t)?e[t]:e[t]=[]).push(n)}),E.indexBy=C(function(e,t,n){e[t]=n}),E.countBy=C(function(e,t,n){E.has(e,t)?e[t]++:e[t]=1}),E.sortedIndex=function(e,t,n,r){n=n==null?E.identity:N(n);var i=n.call(r,t),s=0,o=e.length;while(s<o){var u=s+o>>>1;n.call(r,e[u])<i?s=u+1:o=u}return s},E.toArray=function(e){return e?E.isArray(e)?s.call(e):e.length===+e.length?E.map(e,E.identity):E.values(e):[]},E.size=function(e){return e==null?0:e.length===+e.length?e.length:E.keys(e).length},E.first=E.head=E.take=function(e,t,n){return e==null?void 0:t==null||n?e[0]:s.call(e,0,t)},E.initial=function(e,t,n){return s.call(e,0,e.length-(t==null||n?1:t))},E.last=function(e,t,n){return e==null?void 0:t==null||n?e[e.length-1]:s.call(e,Math.max(e.length-t,0))},E.rest=E.tail=E.drop=function(e,t,n){return s.call(e,t==null||n?1:t)},E.compact=function(e){return E.filter(e,E.identity)};var k=function(e,t,n){return t&&E.every(e,E.isArray)?o.apply(n,e):(S(e,function(e){E.isArray(e)||E.isArguments(e)?t?i.apply(n,e):k(e,t,n):n.push(e)}),n)};E.flatten=function(e,t){return k(e,t,[])},E.without=function(e){return E.difference(e,s.call(arguments,1))},E.uniq=E.unique=function(e,t,n,r){E.isFunction(t)&&(r=n,n=t,t=!1);var i=n?E.map(e,n,r):e,s=[],o=[];return S(i,function(n,r){if(t?!r||o[o.length-1]!==n:!E.contains(o,n))o.push(n),s.push(e[r])}),s},E.union=function(){return E.uniq(E.flatten(arguments,!0))},E.intersection=function(e){var t=s.call(arguments,1);return E.filter(E.uniq(e),function(e){return E.every(t,function(t){return E.indexOf(t,e)>=0})})},E.difference=function(e){var n=o.apply(t,s.call(arguments,1));return E.filter(e,function(e){return!E.contains(n,e)})},E.zip=function(){var e=E.max(E.pluck(arguments,"length").concat(0)),t=new Array(e);for(var n=0;n<e;n++)t[n]=E.pluck(arguments,""+n);return t},E.object=function(e,t){if(e==null)return{};var n={};for(var r=0,i=e.length;r<i;r++)t?n[e[r]]=t[r]:n[e[r][0]]=e[r][1];return n},E.indexOf=function(e,t,n){if(e==null)return-1;var r=0,i=e.length;if(n){if(typeof n!="number")return r=E.sortedIndex(e,t),e[r]===t?r:-1;r=n<0?Math.max(0,i+n):n}if(m&&e.indexOf===m)return e.indexOf(t,n);for(;r<i;r++)if(e[r]===t)return r;return-1},E.lastIndexOf=function(e,t,n){if(e==null)return-1;var r=n!=null;if(g&&e.lastIndexOf===g)return r?e.lastIndexOf(t,n):e.lastIndexOf(t);var i=r?n:e.length;while(i--)if(e[i]===t)return i;return-1},E.range=function(e,t,n){arguments.length<=1&&(t=e||0,e=0),n=arguments[2]||1;var r=Math.max(Math.ceil((t-e)/n),0),i=0,s=new Array(r);while(i<r)s[i++]=e,e+=n;return s};var L=function(){};E.bind=function(e,t){var n,r;if(w&&e.bind===w)return w.apply(e,s.call(arguments,1));if(!E.isFunction(e))throw new TypeError;return n=s.call(arguments,2),r=function(){if(this instanceof r){L.prototype=e.prototype;var i=new L;L.prototype=null;var o=e.apply(i,n.concat(s.call(arguments)));return Object(o)===o?o:i}return e.apply(t,n.concat(s.call(arguments)))}},E.partial=function(e){var t=s.call(arguments,1);return function(){return e.apply(this,t.concat(s.call(arguments)))}},E.bindAll=function(e){var t=s.call(arguments,1);if(t.length===0)throw new Error("bindAll must be passed function names");return S(t,function(t){e[t]=E.bind(e[t],e)}),e},E.memoize=function(e,t){var n={};return t||(t=E.identity),function(){var r=t.apply(this,arguments);return E.has(n,r)?n[r]:n[r]=e.apply(this,arguments)}},E.delay=function(e,t){var n=s.call(arguments,2);return setTimeout(function(){return e.apply(null,n)},t)},E.defer=function(e){return E.delay.apply(E,[e,1].concat(s.call(arguments,1)))},E.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},E.debounce=function(e,t,n){var r,i=null;return function(){var s=this,o=arguments,u=function(){i=null,n||(r=e.apply(s,o))},a=n&&!i;return clearTimeout(i),i=setTimeout(u,t),a&&(r=e.apply(s,o)),r}},E.once=function(e){var t=!1,n;return function(){return t?n:(t=!0,n=e.apply(this,arguments),e=null,n)}},E.wrap=function(e,t){return function(){var n=[e];return i.apply(n,arguments),t.apply(this,n)}},E.compose=function(){var e=arguments;return function(){var t=arguments;for(var n=e.length-1;n>=0;n--)t=[e[n].apply(this,t)];return t[0]}},E.after=function(e,t){return function(){if(--e<1)return t.apply(this,arguments)}},E.keys=b||function(e){if(e!==Object(e))throw new TypeError("Invalid object");var t=[];for(var n in e)E.has(e,n)&&t.push(n);return t},E.values=function(e){var t=E.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=e[t[i]];return r},E.pairs=function(e){var t=E.keys(e),n=t.length,r=new Array(n);for(var i=0;i<n;i++)r[i]=[t[i],e[t[i]]];return r},E.invert=function(e){var t={},n=E.keys(e);for(var r=0,i=n.length;r<i;r++)t[e[n[r]]]=n[r];return t},E.functions=E.methods=function(e){var t=[];for(var n in e)E.isFunction(e[n])&&t.push(n);return t.sort()},E.extend=function(e){return S(s.call(arguments,1),function(t){if(t)for(var n in t)e[n]=t[n]}),e},E.pick=function(e){var n={},r=o.apply(t,s.call(arguments,1));return S(r,function(t){t in e&&(n[t]=e[t])}),n},E.omit=function(e){var n={},r=o.apply(t,s.call(arguments,1));for(var i in e)E.contains(r,i)||(n[i]=e[i]);return n},E.defaults=function(e){return S(s.call(arguments,1),function(t){if(t)for(var n in t)e[n]===void 0&&(e[n]=t[n])}),e},E.clone=function(e){return E.isObject(e)?E.isArray(e)?e.slice():E.extend({},e):e},E.tap=function(e,t){return t(e),e};var A=function(e,t,n,r){if(e===t)return e!==0||1/e==1/t;if(e==null||t==null)return e===t;e instanceof E&&(e=e._wrapped),t instanceof E&&(t=t._wrapped);var i=u.call(e);if(i!=u.call(t))return!1;switch(i){case"[object String]":return e==String(t);case"[object Number]":return e!=+e?t!=+t:e==0?1/e==1/t:e==+t;case"[object Date]":case"[object Boolean]":return+e==+t;case"[object RegExp]":return e.source==t.source&&e.global==t.global&&e.multiline==t.multiline&&e.ignoreCase==t.ignoreCase}if(typeof e!="object"||typeof t!="object")return!1;var s=n.length;while(s--)if(n[s]==e)return r[s]==t;var o=e.constructor,a=t.constructor;if(o!==a&&!(E.isFunction(o)&&o instanceof o&&E.isFunction(a)&&a instanceof a))return!1;n.push(e),r.push(t);var f=0,l=!0;if(i=="[object Array]"){f=e.length,l=f==t.length;if(l)while(f--)if(!(l=A(e[f],t[f],n,r)))break}else{for(var c in e)if(E.has(e,c)){f++;if(!(l=E.has(t,c)&&A(e[c],t[c],n,r)))break}if(l){for(c in t)if(E.has(t,c)&&!(f--))break;l=!f}}return n.pop(),r.pop(),l};E.isEqual=function(e,t){return A(e,t,[],[])},E.isEmpty=function(e){if(e==null)return!0;if(E.isArray(e)||E.isString(e))return e.length===0;for(var t in e)if(E.has(e,t))return!1;return!0},E.isElement=function(e){return!!e&&e.nodeType===1},E.isArray=y||function(e){return u.call(e)=="[object Array]"},E.isObject=function(e){return e===Object(e)},S(["Arguments","Function","String","Number","Date","RegExp"],function(e){E["is"+e]=function(t){return u.call(t)=="[object "+e+"]"}}),E.isArguments(arguments)||(E.isArguments=function(e){return!!e&&!!E.has(e,"callee")}),typeof /./!="function"&&(E.isFunction=function(e){return typeof e=="function"}),E.isFinite=function(e){return isFinite(e)&&!isNaN(parseFloat(e))},E.isNaN=function(e){return E.isNumber(e)&&e!=+e},E.isBoolean=function(e){return e===!0||e===!1||u.call(e)=="[object Boolean]"},E.isNull=function(e){return e===null},E.isUndefined=function(e){return e===void 0},E.has=function(e,t){return a.call(e,t)},E.identity=function(e){return e},E.times=function(e,t,n){var r=Array(Math.max(0,e));for(var i=0;i<e;i++)r[i]=t.call(n,i);return r},E.random=function(e,t){return t==null&&(t=e,e=0),e+Math.floor(Math.random()*(t-e+1))};var O={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};O.unescape=E.invert(O.escape);var M={escape:new RegExp("["+E.keys(O.escape).join("")+"]","g"),unescape:new RegExp("("+E.keys(O.unescape).join("|")+")","g")};E.each(["escape","unescape"],function(e){E[e]=function(t){return t==null?"":(""+t).replace(M[e],function(t){return O[e][t]})}}),E.result=function(e,t){if(e==null)return void 0;var n=e[t];return E.isFunction(n)?n.call(e):n},E.mixin=function(e){S(E.functions(e),function(t){var n=E[t]=e[t];E.prototype[t]=function(){var e=[this._wrapped];return i.apply(e,arguments),B.call(this,n.apply(E,e))}})};var _=0;E.uniqueId=function(e){var t=++_+"";return e?e+t:t},E.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var D=/(.)^/,P={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},H=/\\|'|\r|\n|\t|\u2028|\u2029/g;E.template=function(e,t,n){var r;n=E.defaults({},n,E.templateSettings);var i=new RegExp([(n.escape||D).source,(n.interpolate||D).source,(n.evaluate||D).source].join("|")+"|$","g"),s=0,o="__p+='";e.replace(i,function(t,n,r,i,u){return o+=e.slice(s,u).replace(H,function(e){return"\\"+P[e]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),r&&(o+="'+\n((__t=("+r+"))==null?'':__t)+\n'"),i&&(o+="';\n"+i+"\n__p+='"),s=u+t.length,t}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{r=new Function(n.variable||"obj","_",o)}catch(u){throw u.source=o,u}if(t)return r(t,E);var a=function(e){return r.call(this,e,E)};return a.source="function("+(n.variable||"obj")+"){\n"+o+"}",a},E.chain=function(e){return E(e).chain()};var B=function(e){return this._chain?E(e).chain():e};return E.mixin(E),S(["pop","push","reverse","shift","sort","splice","unshift"],function(e){var n=t[e];E.prototype[e]=function(){var t=this._wrapped;return n.apply(t,arguments),(e=="shift"||e=="splice")&&t.length===0&&delete t[0],B.call(this,t)}}),S(["concat","join","slice"],function(e){var n=t[e];E.prototype[e]=function(){return B.call(this,n.apply(this._wrapped,arguments))}}),E.extend(E.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),E}),define("core",["underscore"],function(e){var t;if(Object.create)t=function(e){return Object.create(e)};else{var n=function(){};t=function(e){n.prototype=e;var t=new n;return n.prototype=null,t}}var r=t(e);r.inherit=t;var s=!1;r.cl=function(){if(s)switch(arguments.length){case 0:console.log();return;case 1:console.log(arguments[0]);return;case 2:console.log(arguments[0],arguments[1]);return;default:console.log(arguments[0],arguments[1],arguments[2]);return}},r.ct=function(){s&&console.trace()},r.isWindow=function(e){return e!=null&&e===e.window},r.isNumeric=r.isNumber,r.isPlainObject=function(e){if(typeof e!="object"||e.nodeType||r.isWindow(e))return!1;try{if(e.constructor&&!hasOwn.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(t){return!1}return!0},r.dictMerge=function(e,t){r.each(t,function(t,n){e[n]=t})},r.arrayMerge=function(e,t,n){var r={},s,o,u;for(i=0;i<t.length;i++)r[n(t[i])]=i;var a=[];for(i=0;i<e.length;i++)s=e[i],o=n(s),a.push(s),delete r[o];var f=e.length-t.length,l;for(var c in r){if(!r.hasOwnProperty(c))continue;u=r[c],s=t[u],l=Math.max(0,u+f),a.splice(l,0,s),f++}return a},r.mapAll=function(e,t,n){var r=[];if(e==null)return r;var i=0,s;for(s=0;s<e.length;s++){var o=e[s].length;o>i&&(i=o)}for(s=0;s<o;s++){var u=[];for(var a=0;a<e.length;a++)u.push(e[a][s]);r.push(t.apply(n,u))}return r},r.stringCompare=function(e,t){var n=Math.min(e.length,t.length);for(var r=0;r<n;r++){var i=e.charCodeAt(r),s=t.charCodeAt(r);if(i!=s)return i-s}return t.length-e.length},r.noop=function(){},r.identity=function(e){return e},r.gattr=function(e){return function(t){return t[e]}},r.unsplat=function(e,t){return t?function(){var n=[],i=r.toArray(arguments);for(var s=0;s<e;s++)n.push(i.shift());return n.push(i),t.apply(this,n)}:(t=e,function(){return t(r.toArray(arguments))})},r.splat=function(e){return function(t){return e.apply(this,t)}},r.dictIsEmpty=r.isEmpty,r.dictIsEqual=r.isEqual,r.truthiness=function(e){switch(e){case 0:case!1:case null:case undefined:return!1;case!0:return!0}if(typeof e=="string")return/[^\s]/.test(e);if(r.isNumeric(e))return!0;if(e.length!==undefined)return e.length>0;for(var t in e)if(e.hasOwnProperty(t))return!0;return e.nodeType?!0:!1},r.removeWhitespace=function(e){return e.replace(/\s/g,"")},r.whitespaceEqual=function(e,t){return r.truthiness(e)!==r.truthiness(t)?!1:r.removeWhitespace(e)==r.removeWhitespace(t)},r.future=function(){var e=[],t=[],n=!1,i=!1,s=null,o=function(r,o){i?(n?o:r).apply(s[0],s[1]):(e.push(r),t.push(o))};return o.addReader=o,o.fail=function(){if(i)return;s=[this,r.toArray(arguments)],i=!0,n=!0;while(t.length>0)t.shift().apply(this,arguments)},o.fire=function(){if(i)return;s=[this,r.toArray(arguments)],i=!0;while(e.length>0)e.shift().apply(this,arguments)},o},r.multi=function(e){var t=[],n=[],i=0,s=0,o=!1,u=!1,a=function(){o&&!u&&s>=i&&(u=!0,e(t))},f=function(e,r){t[e]=r,n[e]||(s++,n[e]=!0),a()};return{addValue:function(e){var r=i;t.push(e),n.push(!0),i++,s++},getCallback:function(){if(o)return r.noop;var e=i;return t.push(null),n.push(!1),i++,r.partial(f,e)},start:function(){o=!0,a()}}},r.pipe=function(){var e=[],t=[];return{addReader:function(n){var r=t.length;t.push(n);while(e.length>0)n(e.shift());return r},buffer:e,removeReader:function(e){t[e]=null},write:function(n){if(r.some(t))for(var i=0;i<t.length;i++){var s=t[i];s&&s(n)}else e.push(n)}}},r.maybe_function=function(e){return typeof e=="function"?e:function(){return e}},r.uniqueDebounce=function(e,t){t||(t=100);var n=!1,i=[],s=function(){while(i.length>0)e(i.shift());n=!1};return function(o){n?r.contains(i,o)||i.push(o):(e(o),n=!0,setTimeout(s,t))}},r.reTester=function(e){return function(t){return e.test(t)}},r.hasOnlyKeys=function(e,t){for(var n in e){if(!e.hasOwnProperty(n))continue;if(r.indexOf(t,n)==-1)return!1}return!0},r.clean=function(e){return r.filter(e,r.truthiness)};var o=/-([\da-z])/gi,u=function(e,t){return t.toUpperCase()};r.camelCase=function(e){return e.replace(rmsPrefix,"ms-").replace(o,u)},r.replace=function(e,t){for(var n=0;n<e.length;n++){var r=e[n],i=t(r);i!==!1&&(e[n]=i)}},r.indexOf=function(e,t,n,r){r=typeof r=="undefined"?0:r;if(n){for(r;r<e.length;r++)if(n(t,e[r]))return r;return-1}if(e.indexOf&&r===0)return e.indexOf(t);for(r;r<e.length;r++)if(e[r]==t)return r;return-1};var a=/(<[^>]*>|[^\w\s]+)/;return r.sentenceSplit=function(e){var t=e.split(a),n=[];for(var r=0;r<t.length;r++){var i=t[r];r%2===0?n.push(i):n[n.length-1]=n[n.length-1]+i}var s=0,o=[];for(var r=0;r<n.length;r++)o.push(s),s+=n[r].length;return[n,o]},r.logsErrors=function(e){return e},r.throttle=function(e,t,n){var r,i,s,o=null,u=0;n||(n={});var a=function(){u=n.leading===!1?0:new Date,o=null,s=e.apply(r,i)};return function(){var f=new Date;!u&&n.leading===!1&&(u=f);var l=t-(f-u);return r=this,i=arguments,l<=0?(clearTimeout(o),o=null,u=f,s=e.apply(r,i)):!o&&n.trailing!==!1&&(o=setTimeout(a,l)),s}},r.extend=function(){var e,t,n,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;typeof u=="boolean"&&(l=u,u=arguments[1]||{},a=2),typeof u!="object"&&!r.isFunction(u)&&(u={}),f===a&&(u=this,--a);for(;a<f;a++)if((e=arguments[a])!=null)for(t in e){n=u[t],i=e[t];if(u===i)continue;l&&i&&(r.isPlainObject(i)||(s=r.isArray(i)))?(s?(s=!1,o=n&&r.isArray(n)?n:[]):o=n&&r.isPlainObject(n)?n:{},u[t]=r.extend(l,o,i)):i!==undefined&&(u[t]=i)}return u},r}),define("load_swf",[],function(){var e={};e.random_string=function(e){var t=[];for(var n=0;n<e;n++)t.push(String.fromCharCode(Math.floor(Math.random()*26)+97));return t.join("")};var t=function(){var e=new ActiveXObject("ShockwaveFlash.ShockwaveFlash");return!!e.getVariable("$version")},n=function(){for(;;){var t=e.random_string(10);if(!document.getElementById(t))return t}},r=!1,i=[],s=function(){if(r)return;r=!0;while(i.length>0)i.pop()()},o=function(){if(document.readyState=="complete"||typeof document.readyState=="undefined"&&(document.getElementsByTagName("body")[0]||document.body)){s();return}if(document.addEventListener){document.addEventListener("DOMContentLoaded",s,!1);return}if(document.attachEvent){var e;e=function(){document.readyState=="complete"&&(s(),document.detachEvent("onreadystatechange",e))},document.attachEvent("onreadystatechange",e);return}var t;t=setInterval(function(){if(r||/loaded|complete/.test(document.readyState))s(),clearInterval(t)},10)};return o(),e.onReady=function(e){r?e():i.push(e)},e.create=function(e,r,i,s){s||(s=n()),r=r||{},i=i||{},r.width=r.width||1,r.height=r.height||1;var o;if(t()){o=document.createElement("div"),o.style.visibility="hidden",o.setAttribute("id",s);var u=[];for(var a in r){if(!r.hasOwnProperty(a))continue;switch(a.toLowerCase()){case"styleclass":u.push(' class="'),u.push(r[a]),u.push('"');break;case"classid":u.push(' classid="'),u.push(r[a]),u.push('"');break;default:u.push(" "),u.push(a),u.push('="'),u.push(r[a].replace('"',"%22")),u.push('"')}}i.movie=e;var f=[];for(a in i){if(!i.hasOwnProperty(a))continue;f.push('<param name="'),f.push(a),f.push('" value="'),f.push(i[a]),f.push('"> ')}return o.outerHTML='<object classid="clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"'+u.join("")+">"+f.join("")+"</object>",document.getElementById("id").firstChild}o=document.createEleement("object"),o.setAttribute("type","application/x-shockwave-falsh");for(var a in r){if(!r.hasOwnProperty(a))continue;a.toLowerCase()=="styleclass"?o.setAttribute("class",r[a]):o.setAttribute(a,r[a])}for(a in i){if(!i.hasOwnProperty(a))continue;var l=document.createElement("param");l.setAttribute("name",a),l.setAttribute("value",i[a]),o.appendChild(l)}o.style.visibility="hidden",document.body.appendChild(o)},e}),define("socket",["load_swf","core"],function(e,t){var n={},r="/WebSocketMainInsecure.swf",i=function(){for(;;){var t=e.random_string(10);if(!(t in window))return t}},s=function(e){var t=50;return function(){setTimeout(e,t),t<1e3&&(t*=2)}};if(window.WebSocket)n.connect=function(e){e=t.maybe_function(e);var n,r=t.pipe(),i=t.future(),o=[],u=!1,a=!1,f,l;return f=function(){n=new WebSocket(e()),n.onopen=function(){var e=a;a=!0;while(o.length>0&&n.readyState===1)n.send(JSON.stringify(o.shift()));e||i.fire()},n.onerror=function(e){n.readyState!==1&&(n.close(),l())},n.onmessage=function(e){var n=JSON.parse(e.data);t.isArray(n)?t.each(r.write,n):r.write(n)},n.onclose=function(){a=!1,u||l()}},l=s(f),f(),{send:function(e){var t=JSON.stringify(e);if(u)return!1;for(;;){var r;if(a&&n.readyState===1)try{n.send(t);break}catch(r){}o.push(e);break}},onOpen:i,removeOpenCallback:i.remove,onMessage:r.addReader,removeMessageCallback:r.removeReader,close:function(){u=!0,n.close()}}};else{var o=i(),u=null,a=!1,f=[];window[o]=function(e){if(e=="load"){a=!0;while(f.length>0)f.shift()(u)}else f[e.webSocketId](e)};var l=function(e){a?e(u):f.push(e)};e.onReady(function(){u=e.create(r,{},{hasPriority:!0,swliveconnect:!0,allowScriptAccess:"always",flashVars:"callbackName=window."+o})}),soket.connect=function(e){e=t.maybe_function(e);var n=f.length,r=t.pipe(),i=t.future(),o=[],a=!1,c=!1,h=function(){l(function(t){t.create(n,e(),[])})},p=s(h);return f.push(function(e){switch(e.type){case"message":var t=decodeURIComponent(e.message);r.write(JSON.parse(t));break;case"close":a||p();break;case"open":c=!0;while(o.length>0)u.send(n,JSON.stringify(o.shift()));i.fire()}}),h(),{send:function(e){if(a)return!1;c?u.send(n,JSON.stringify(e)):o.push(e)},onOpen:i,removeOpenCallback:i.remove,onMessage:r.addReader,removeMessageCallback:r.removeReader,close:function(){a=!0,c&&u.close(n)}}}}return n}),define("Data",["core"],function(e){function n(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Math.random()}var t=/\S/;return n.uid=1,n.accepts=function(e){var t;try{return e.nodeType?e.nodeType===1||e.nodeType===9:!0}catch(t){}},n.prototype={acceptData:function(e){return e.nodeType?e.nodeType===1||e.nodeType===9:!0},key:function(t){if(!n.accepts(t))return 0;var r={},i=t[this.expando];if(!i){i=n.uid++;try{r[this.expando]={value:i},Object.defineProperties(t,r)}catch(s){r[this.expando]=i,e.extend(t,r)}}return this.cache[i]||(this.cache[i]={}),i},set:function(t,n,r){var i,s=this.key(t),o=this.cache[s];if(typeof n=="string")o[n]=r;else if(e.isEmptyObject(o))e.extend(this.cache[s],n);else for(i in n)o[i]=n[i];return o},get:function(e,t){var n=this.cache[this.key(e)];return t===undefined?n:n[t]},access:function(t,n,r){var i;return n===undefined||n&&typeof n=="string"&&r===undefined?(i=this.get(t,n),i!==undefined?i:this.get(t,e.camelCase(n))):(this.set(t,n,r),r!==undefined?r:n)},remove:function(n,r){var i,s,o,u=this.key(n),a=this.cache[u];if(r===undefined)this.cache[u]={};else{e.isArray(r)?s=r.concat(r.map(e.camelCase)):(o=e.camelCase(r),r in a?s=[r,o]:(s=o,s=s in a?[s]:s.match(t)||[])),i=s.length;while(i--)delete a[s[i]]}},hasData:function(t){return!e.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(e){e[this.expando]&&delete this.cache[e[this.expando]]}},new n}),define("ids",[],function(){var e={},t=function(e,t){var n="djc:"+e;localStorage.setItem(n,t)},n=function(e){return localStorage.getItem("djc:"+e)},r=n("session_id");return r?e.session_id=r:(e.session_id=Math.floor(Math.random()*1e16).toString(),t("session_id",e.session_id)),e.session_id+="-"+Math.floor(Math.random()*1e3),e.counter=function(e){var r=n(e),i=parseInt(r||0,10);return t(e,(i+1).toString()),i},e.global_timestamp=function(e,r){var i="gs:"+e,s=parseInt(n(i)||0,10);return r&&r>s?(t(i,r.toString()),r):s},e.node_ctr=function(){var t=e.counter("node_ctr");return t},e.message_ctr=function(t){return e.counter("message_ctr:"+t)},e.node_id=function(t){return[e.session_id,t,e.node_ctr()].join("-")},e.message_id=function(t){return[t,e.global_timestamp(t),e.session_id,e.message_ctr(t)]},e}),define("dom",["core","Data","ids"],function(e,t,n){var r={};r.traverse=function(e,t){if(!e)return;e.nodeType==Node.ELEMENT_NODE&&t(e);var n=r.getChildNodes(e);for(var i=0;i<n.length;i++){var s=n[i];s.nodeType==Node.ELEMENT_NODE&&r.traverse(n[i],t)}},r.nodeCompare=function(e,t){return e==t?!0:e.nodeType!=t.nodeType?!1:e.nodeType==Node.TEXT_NODE?e.data==t.data:!1},r.stringifyNode=function(e){return e.nodeType==Node.TEXT_NODE?"t:"+e.data:e.nodeType==Node.ELEMENT_NODE?r.get_node_id(e):""},r.nodeParentIndex=function(t){var n=t.parentNode,i=e.indexOf(r.getChildNodes(n),t);return[n,i]},r.elementParentIndex=function(t){var n=t.parentNode,i=r.getChildNodes(n),s=e.indexOf(e.filter(i,r.isElement),t);return[n,s]},r.isElement=function(e){return e.nodeType==Node.ELEMENT_NODE},r.isTextNode=function(e){return!!e&&e.nodeType===Node.TEXT_NODE},r.iterAttributes=function(e,t){for(var n=0;n<e.attributes.length;n++){var r=e.attributes[n];t(n.name,n.value)}},r.updateAttributes=function(t,n,i){var s=[];r.iterAttributes(t,function(e,r){n[e]?n[e]!=r&&t.setAttribute(e,r):t.removeAttribute(e),s.push(e)}),e.each(n,function(e,n){t.setAttribute(n,e)}),e.each(i,function(e,n){t.removeAttribute(n)})},r.removeAllAttributes=function(t){var n=[];r.iterAttributes(t,function(e,t){n.push(e)}),e.each(n,function(e){t.removeAttribute(e)})},r.setAttributes=function(t,n){e.each(n,function(e,n){t.setAttribute(n,e)})},r.setIdClass=function(t,n){var r=t.getAttribute("class"),i;r?(i=e.filter(r.split(/\s+/g),function(e){return!/^dynajot-/.test(e)}),res=i.join(" ")):i=[],i.push("dynajot-"+n),t.setAttribute("class",i.join(" "))},r.toFragment=function(e){var t=document.createDocumentFragment(),n;for(n=0;n<e.length;n++)t.appendChild(e[n]);return t},r.getChildNodes=function(t){return t?e.toArray(t.childNodes):[]},r.removeAllChildren=function(e){while(e.firstChild)e.removeChild(e.firstChild)},r.mergeChildren=function(e,t,n){r.removeAllChildren(e);var i=r.toFragment(t);e.appendChild(i)},r.spliceNodes=function(t,n,i,s){var o=e.filter(r.getChildNodes(t),function(t){return e.indexOf(s,t)===-1}),u,a,f=r.toFragment(s);for(u=n;u<Math.min(i,o.length);u++)o[u]&&t.removeChild(o[u]);var l=o[i];l?t.insertBefore(f,l):t.appendChild(f)},r.yankNode=function(e){e.parentNode&&e.parentNode.removeChild(e)};var i=0;return r.insertNodeAt=function(e,t,n){var r=e.childNodes[n];if(!r)e.appendChild(t);else if(r.nodeType==Node.ELEMENT_NODE)e.insertBefore(t,r);else{var i=document.createDocumentFragment();i.appendChild(t);while(r&&r.nodeType!=Node.ELEMENT_NODE){var s=r.nextSibling;e.removeChild(r),i.appendChild(r),r=s}r?e.insertBefore(i,r):e.appendChild(i)}},r.isChildOf=function(e,t){var n=t;while(n&&n!=document){if(n.parentNode==e)return!0;n=n.parentNode}return!1},r.getNodeById=function(n){var r=t.get(n,"node_id");if(r)return r;var i=n.getAttribute("class");if(!i)return null;var s=e.filter(i.split(),e.reTester(/^dynajot-.*/));return s.length>0?s[0]:null},r.set_node_id=function(e,n){t.set(e,"node_id",n),r.setIdClass(e,n)},r.assign_node_id=function(e,i,s){if(i==e)return"_root";var o=t.get(i,"node_id");if(o)return o;var u=n.node_id(s);return r.set_node_id(i,u),u},r.assign_all_ids=function(e,t,n){r.traverse(t,function(t){r.assign_node_id(e,t,n)})},r.get_node_id=function(e){return t.get(e,"node_id")},r}),define("difflib",["core"],function(e){var t={" ":!0,"	":!0,"\n":!0,"\f":!0,"\r":!0},n;return n={defaultJunkFunction:function(e){return t.hasOwnProperty(e)},stripLinebreaks:function(e){return e.replace(/^[\n\r]*|[\n\r]*$/g,"")},stringAsLines:function(e){var t=e.indexOf("\n"),r=e.indexOf("\r"),i=t>-1&&r>-1||r<0?"\n":"\r",s=e.split(i);for(var o=0;o<s.length;o++)s[o]=n.stripLinebreaks(s[o]);return s},__reduce:function(e,t,n){if(n!=null)var r=n,i=0;else{if(!t)return null;var r=t[0],i=1}for(;i<t.length;i++)r=e(r,t[i]);return r},__ntuplecomp:function(e,t){var n=Math.max(e.length,t.length);for(var r=0;r<n;r++){if(e[r]<t[r])return-1;if(e[r]>t[r])return 1}return e.length==t.length?0:e.length<t.length?-1:1},__calculate_ratio:function(e,t){return t?2*e/t:1},__isindict:function(e){return function(t){return e.hasOwnProperty(t)}},__dictget:function(e,t,n){return e.hasOwnProperty(t)?e[t]:n},SequenceMatcher:function(e,t,r){this.set_seqs=function(e,t){this.set_seq1(e),this.set_seq2(t)},this.set_seq1=function(e){if(e==this.a)return;this.a=e,this.matching_blocks=this.opcodes=null},this.set_seq2=function(e){if(e==this.b)return;this.b=e,this.matching_blocks=this.opcodes=this.fullbcount=null,this.__chain_b()},this.__chain_b=function(){var e=this.b,t=e.length,r=this.b2j={},i={};for(var s=0;s<e.length;s++){var o=e[s];if(r.hasOwnProperty(o)){var u=r[o];t>=200&&u.length*100>t?(i[o]=1,delete r[o]):u.push(s)}else r[o]=[s]}for(var o in i)i.hasOwnProperty(o)&&delete r[o];var a=this.isjunk,f={};if(a){for(var o in i)i.hasOwnProperty(o)&&a(o)&&(f[o]=1,delete i[o]);for(var o in r)r.hasOwnProperty(o)&&a(o)&&(f[o]=1,delete r[o])}this.isbjunk=n.__isindict(f),this.isbpopular=n.__isindict(i)},this.find_longest_match=function(e,t,r,i){var s=this.a,o=this.b,u=this.b2j,a=this.isbjunk,f=e,l=r,c=0,h=null,p={},d=[];for(var v=e;v<t;v++){var m={},g=n.__dictget(u,s[v],d);for(var y in g)if(g.hasOwnProperty(y)){h=g[y];if(h<r)continue;if(h>=i)break;m[h]=k=n.__dictget(p,h-1,0)+1,k>c&&(f=v-k+1,l=h-k+1,c=k)}p=m}while(f>e&&l>r&&!a(o[l-1])&&s[f-1]==o[l-1])f--,l--,c++;while(f+c<t&&l+c<i&&!a(o[l+c])&&s[f+c]==o[l+c])c++;while(f>e&&l>r&&a(o[l-1])&&s[f-1]==o[l-1])f--,l--,c++;while(f+c<t&&l+c<i&&a(o[l+c])&&s[f+c]==o[l+c])c++;return[f,l,c]},this.get_matching_blocks=function(){if(this.matching_blocks!=null)return this.matching_blocks;var e=this.a.length,t=this.b.length,r=[[0,e,0,t]],i=[],s,o,u,a,f,l,c,h,p;while(r.length)f=r.pop(),s=f[0],o=f[1],u=f[2],a=f[3],p=this.find_longest_match(s,o,u,a),l=p[0],c=p[1],h=p[2],h&&(i.push(p),s<l&&u<c&&r.push([s,l,u,c]),l+h<o&&c+h<a&&r.push([l+h,o,c+h,a]));i.sort(n.__ntuplecomp);var d=j1=k1=block=0,v=[];for(var m in i)i.hasOwnProperty(m)&&(block=i[m],i2=block[0],j2=block[1],k2=block[2],d+k1==i2&&j1+k1==j2?k1+=k2:(k1&&v.push([d,j1,k1]),d=i2,j1=j2,k1=k2));return k1&&v.push([d,j1,k1]),v.push([e,t,0]),this.matching_blocks=v,this.matching_blocks},this.get_opcodes=function(){if(this.opcodes!=null)return this.opcodes;var e=0,t=0,n=[];this.opcodes=n;var r,i,s,o,u,a=this.get_matching_blocks();for(var f in a)a.hasOwnProperty(f)&&(r=a[f],i=r[0],s=r[1],o=r[2],u="",e<i&&t<s?u="replace":e<i?u="delete":t<s&&(u="insert"),u&&n.push([u,e,i,t,s]),e=i+o,t=s+o,o&&n.push(["equal",i,e,s,t]));return n},this.get_grouped_opcodes=function(e){e||(e=3);var t=this.get_opcodes();t||(t=[["equal",0,1,0,1]]);var n,r,i,s,o,u;t[0][0]=="equal"&&(n=t[0],r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],t[0]=[r,Math.max(i,s-e),s,Math.max(o,u-e),u]),t[t.length-1][0]=="equal"&&(n=t[t.length-1],r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],t[t.length-1]=[r,i,Math.min(s,i+e),o,Math.min(u,o+e)]);var a=e+e,f=[];for(var l in t)t.hasOwnProperty(l)&&(n=t[l],r=n[0],i=n[1],s=n[2],o=n[3],u=n[4],r=="equal"&&s-i>a&&(f.push([r,i,Math.min(s,i+e),o,Math.min(u,o+e)]),i=Math.max(i,s-e),o=Math.max(o,u-e)),f.push([r,i,s,o,u]));return f&&f[f.length-1][0]=="equal"&&f.pop(),f},this.ratio=function(){return matches=n.__reduce(function(e,t){return e+t[t.length-1]},this.get_matching_blocks(),0),n.__calculate_ratio(matches,this.a.length+this.b.length)},this.quick_ratio=function(){var e,t;if(this.fullbcount==null){this.fullbcount=e={};for(var r=0;r<this.b.length;r++)t=this.b[r],e[t]=n.__dictget(e,t,0)+1}e=this.fullbcount;var i={},s=n.__isindict(i),o=numb=0;for(var r=0;r<this.a.length;r++)t=this.a[r],s(t)?numb=i[t]:numb=n.__dictget(e,t,0),i[t]=numb-1,numb>0&&o++;return n.__calculate_ratio(o,this.a.length+this.b.length)},this.real_quick_ratio=function(){var e=this.a.length,t=this.b.length;return _calculate_ratio(Math.min(e,t),e+t)},this.isjunk=r?r:n.defaultJunkFunction,this.a=this.b=null,this.set_seqs(e,t)}},n}),define("mutation",["dom","core"],function(e,t){var n={};return n.throttledPoll=function(e,t){var n=t,r=function(){var i=Date.now();e();var s=Date.now()-i;n=Math.round((t+s*2)/2),setTimeout(r,n)}},n.onChange=function(n,r,i){var s=t.uniqueDebounce(r,i),o=function(t){e.isChildOf(t,n)||s(t)};if(typeof MutationObserver!="undefined"){var u=new MutationObserver(function(t){for(var n=0;n<t.length;n++){var r=t[n];e.traverse(r.target,o)}});u.observe(n,{childList:!0,attributes:!0,characterData:!0,subtree:!0})}else n.addEventListener("DOMSubtreeModified",function(t){e.traverse(t.target||n,o)});setInterval(function(){e.traverse(n,r)},500)},n}),define("change",["core","Data","dom","difflib","mutation"],function(e,t,n,r,i){var s={},o={onclick:!0,ondblclick:!0,onmousedown:!0,onmouseup:!0,onmouseover:!0,onmousemove:!0,onmouseout:!0,ondragstart:!0,ondrag:!0,ondragenter:!0,ondragleave:!0,ondragover:!0,ondrop:!0,ondragend:!0,onkeydown:!0,onkeypress:!0,onkeyup:!0,onload:!0,onunload:!0,onabort:!0,onerror:!0,onresize:!0,onscroll:!0,onselect:!0,onchange:!0,onsubmit:!0,onreset:!0,onfocus:!0,onblur:!0};s.serializeNode=function(t,r,i){if(!r)return{};if(!r.parentNode)return{};var u={};if(n.isTextNode(r))return s.serializeNode(t,r.parent,i);u.attrs={};if(r.hasAttributes())for(var a=0;a<r.attributes.length;a++){var f=r.attributes[a].name,l=r.attributes[a].value;if(o.hasOwnProperty(f.toLowerCase()))continue;if(f=="class"){l=l.replace(/dynajot-[^\s]*/g,""),l=l.replace(/\s+/g," "),l=l.trim();if(l.length===0)continue}u.attrs[f]=l}return u.name=r.tagName.toLowerCase(),u.children=e.map(n.getChildNodes(r),function(e){return n.isTextNode(e)?{kind:"text",value:e.data}:{kind:"id",value:n.assign_node_id(t,e,i)}}),r==t?u.position=null:u.position={parent:n.assign_node_id(t,r.parentNode,i),index:n.nodeParentIndex(r)[1]},u.id=n.assign_node_id(t,r,i),u},s.updateState=function(e,r,i){if(n.isTextNode(r))return;var o=r.getAttribute("data-id");o&&(n.set_node_id(r,o),r.removeAttribute("data-id"));var u=s.serializeNode(e,r,i);return t.set(r,"state",u),u},s.mergeDeltas=function(t,n){n.attrs&&(t.attrs||(t.attrs={}),e.dictMerge(t.attrs,n.attrs)),n.position&&(t.position=e.inherit(n.position)),n.message_id&&(t.message_id=n.message_id),n.children&&(t.children&&t.children.length>0?Array.prototype.push.apply(t.children,n.children):t.children=n.children)},s.sentenceDiff=function(t,n){var i=e.sentenceSplit(t),s=e.sentenceSplit(n),o=i[0],u=i[1],a=s[0],f=s[1],l=new r.SequenceMatcher(o,a),c=l.get_opcodes(),h=[];for(var p=0;p<c.length;p++){var d=c[p],v=c[0],m=c[1],g=c[2],y=c[3],b=c[4];switch(v){case"replace":h.push({action:"replace",start:u[m],end:u[g],value:a.slice(y,b).join("")});break;case"delete":h.push({action:"delete",start:u[m],end:u[g],value:null});break;case"insert":h.push({action:"insert",start:u[m],end:u[g],valie:a.slice(y,b).join("")})}}return h},s.patch=function(e,t){var n=e,r=0;t.sort(function(e,t){return e.start-t.start});for(var i=0;i<t.length;i++){var s=t[i];switch(s.action){case"replace":n=n.slice(0,r+s.start)+s.value+n.slice(r+s.end),r+=s.end-s.start+s.value.length;break;case"delete":n=n.slice(0,r+s.start)+n.slice(r+s.end),r-=s.end-s.start;break;case"insert":n=n.slice(0,r+s.start)+s.value+e.slice(r+s.start),r+=s.value.length}}return n},s.delta=function(t,n){var r=e.clone(n);return r.removed_children=e.filter(t.children,function(t){return e.indexOf(n.children,t,e.isEqual)==-1}),r.removed_attrs={},e.each(t.attrs,function(e,t){t in n.attrs||(r.removed_attrs[t]=e)}),r},s.nodeTransactions=function(n,r,i){e.each(r,function(e){t.set(e,"dirty",!0)}),i(),e.each(r,function(e){s.updateState(n,e),t.set(e,"dirty",!1)})},s.nodeTransaction=function(e,n,r){if(!n.parentNode){r({},n);return}t.set(n,"dirty",!0),r(t.get(n,"state"),n),s.updateState(e,n),t.set(n,"dirty",!1)};var u=!1;return s.changes=function(r,o,a){var f=function(e){return n.assign_node_id(r,e,o)},l=function(i){if(u)return;n.isTextNode(i)&&(i=i.parentNode);if(!i)return;if(t.get(i,"dirty")){setTimeout(e.partial(l,i),200);return}var f=!!t.get(i,"seen"),c=t.get(i,"state"),h=s.serializeNode(r,i,o);if(!e.truthiness(h))return;c?!e.isEmpty(h)&&!e.isEqual(c,h)&&a(s.delta(c,h)):a(h),t.set(i,"state",h),t.set(i,"seen",!0)};i.onChange(r,l,200)},s}),define("schema",["core"],function(e){var t={};return t.t={},t.t.array=e.isArray,t.t.element=e.isElement,t.t.fn=e.isFunction,t.t.string=e.isString,t.t.number=e.isNumber,t.t.bool=e.isBoolean,t.t.dict=e.isObject,t.t.any=function(n){return function(r){return e.every(r,e.partial(t.validate,n))}},t.t.nullable=function(e){return function(n){return n===null?!0:t.validate(e,n)}},t.errback=function(e,t,n){console.trace()},t.validate=function(n,r){if(n==r)return!0;if(typeof n=="function")return n(r);if(typeof n!=typeof r)return!1;if(e.isArray(n)!=e.isArray(r))return!1;if(e.isObject(n)!=e.isObject(r))return!1;var i=!0,s=null;return e.each(r,function(e,r){var s=n[r];if(!s)return i=!1,!1;if(!t.validate(s,e))return i=!1,!1}),i?(e.each(n,function(e,t){if(!(t in r))return i=!1,!1}),i):i},t.inp_validated=function(e,n,r){return r||(r=t.errback),function(i){return t.validate(e,i)||r(n,e,i),n(i)}},t.outp_validated=function(e,n,r){return r||(r=t.errback),function(){var i=n.apply(this,arguments);return t.validate(e,i)||r(n,e,i),i}},t.Delta={id:t.t.string,name:t.t.string,message_id:t.t.nullable([t.t.string,t.t.number,t.t.string,t.t.number]),attrs:{"+":t.t.dict,"-":t.t.dict},position:t.t.nullable({parent:t.t.string,offset:t.t.number}),children:t.t.any({kind:t.t.string,value:t.t.string})},t.Element={id:t.t.string,attrs:t.t.dict,position:{parent:t.t.string,index:t.t.number},children:t.t.any({kind:t.t.string,value:t.t.string})},t}),define("enact",["core","dom","change","Data","schema"],function(e,t,n,r,i){var s={},o={};return s.getNode=function(e,t){var n;t==="_root"?n=e:n=e.querySelector(".dynajot-"+t);if(n)return o[t]=n,n;var n=o[t]||null;return n},s.resolveNode=function(e,t){return t.kind=="text"?document.createTextNode(t.value):s.getNode(e,t.value)},s.insertionIndex=function(e,t){var n=r.get(e,"children_resolved");if(!n)return t;var i=0;for(var s=0;s<t;s++)n[s]||i++;return t-i},s.insertChildNodeAt=function(e,n,i){var o=r.get(e,"children_resolved"),u=o?s.insertionIndex(e,i):i;t.insertNodeAt(e,n,u),o&&(o[i]=!0,r.set(e,"children_resolved",o))},s.appliesDeltas=function(i,o){var u,a={},f=function(e,t){u(t);var n=a[e];while(n&&n.length>0)n.shift()(t);delete a[e]},l=function(t,n){var r=s.getNode(i,t);if(r){n(r);return}a[t]?a[t].push(n):(o(t,e.partial(f,t)),a[t]=[n])},c=e.partial(s.resolveNode,i);return u=function(o){var u=o.id,a=s.getNode(i,u),f=function(u){var f=function(n,i,s){s=s||[];var o=e.map(i,c),u=e.map(o,e.truthiness);return r.set(n,"children_resolved",u),t.mergeChildren(n,e.clean(o),s)},l=[];a&&l.push(a),u&&l.push(u),n.nodeTransactions(i,l,function(){if(a){e.cl("existing");if(u&&u!=i){var n=a.parentNode,r=t.get_node_id(n),l=t.nodeParentIndex(a)[1];if(o.position.parent!=r||o.position.index!=l)t.yankNode(a),s.insertChildNodeAt(u,a,o.position.index)}o.attrs&&t.updateAttributes(a,o.attrs,o.removed_attrs),o.children&&f(a,o.children,o.removed_children)}else{e.cl("new",o.id,s.getNode(i,o.id));var c=document.createElement(o.name);o.attrs&&t.updateAttributes(c,o.attrs),o.children&&f(c,o.children),t.set_node_id(c,o.id),s.insertChildNodeAt(u,c,o.position.index)}})};o.position?l(o.position.parent,f):f(null)},u},s}),define("timeline",["ids","core","change"],function(e,t,n){var r={};return r.make=function(r){var i=[],s={};s._locals={},s._locals.sequence=i;var o=function(e,n){var r=e.message_id,i=n.message_id;return r[1]!=i[1]?r[1]-i[1]:r[2]!=i[2]?t.stringCompare(r[2],i[2]):r[3]-i[3]};s._locals.compareDeltas=o;var u=function(e){if(i.length===0)return 0;if(i.length===1)return o(e,i[0])>0?1:0;var t=0,n=i.length,r=o(e,i[n-1]);if(r>=0)return n;while(n>t&&t>=0){var s=t+Math.round((n-t)/2),u=o(e,i[s]);if(u===0)return s;if(s>=n)return n;u>0?t=s:n=s}return t};s._locals.insertionPoint=u;var a=function(e){var r=t.groupBy(e,t.gattr("id")),i={};for(var s in r){if(!r.hasOwnProperty(s))continue;var o=r[s],u=t.inherit(o[0]);for(var a=1;a<o.length;a++)n.mergeDeltas(u,o[a]);i[s]=u}return t.values(i)};return s._locals.mergeDeltas=a,s.addDelta=function(n){n=t.inherit(n),n.message_id||(n.message_id=e.message_id(r));var s=u(n);return i.splice(s,0,n),i.slice(s)},s.changeset=function(e){var t=s.addDelta(e);return a(t)},s},r}),define("cursors",["core","ids","dom"],function(e,t,n){var r={};r.id="dj-cursor-stable",r.user={},r.send_fn=null;var i={};i.generateUUID=function(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(e){var t=Math.random()*16|0,n=e=="x"?t:t&3|8;return n.toString(16)})};var s={};s.createCursor=function(e){var t=['<div id="dj-presence-mouse-'+e.id+'" class="dj-mouse">','<div class="dj-filler-wrap">','<div class="dj-filler">'+e.name+"</div>","</div>","</div>"].join(""),n=$("div");return n.html(t),$("#"+r.id).append(n),n},s.getOrCreateCursor=function(e){return $cursor=o[e.id],$cursor?$cursor:($cursor=s.createCursor(e),o[e.id]=$cursor,$cursor)};var o={},u=function(e){r.send_fn(e)};return r.init=function(t){r.send_fn=t;var n=document.createElement("div");n.id=r.id,n.css="position: absolute; top:0; left:0;",document.body.appendChild(n);var s=prompt("What is your name?");r.user={name:s,id:i.generateUUID()};var o={mouse_position:{enter:!0},user:r.user};u({kind:"mouse_position",value:o}),$("body").on("mousemove",e.throttle(function(e){var t={mouse_position:{mousemove:{coords:[e.pageX,e.pageY]}},user:{name:r.user.name,id:r.user.id}};u({kind:"mouse_position",value:t})},75))},r.updateCursors=function(e){var t=JSON.parse(e.data),n,r,i,u,a,f;t.kind==="mouse_position"&&(u=t.value,u.action.enter&&(a=s.createCursor(u.user),o[u.user.id]=a),u.action.leave&&(s.removeUserCursor(u.user),delete o[u.user.id]),u.action.mousemove&&(n=u.action.mousemove.coords,r=n[0],i=n[1],f=s.getOrCreateCursor(u.user),f.css({top:i,left:r}),f.find(".dj-filler").text(u.user.name)))},r}),define("sync",["core","socket","change","enact","dom","timeline","cursors","ids","Data"],function(e,t,n,r,i,s,o,u,a){var f={};return f.DEVELOP_MODE=!1,f.sync=function(l,c){c=c||{};var h=c.document_id,p=window.location.hash.slice(1).trim();!h&&e.truthiness(p)&&(h=p);var d="ws://damp-cove-5558.herokuapp.com/doc/";f.DEVELOP_MODE&&(d="ws://localhost:5000/doc");var v,m=t.connect(function(){return h?d+h:d}),g={document_id:e.pipe(),document_state:e.pipe(),message:e.pipe(),response:e.pipe()},y=0,b={},w=function(e,t){var n=y;y++,b[n]=t,m.send({kind:"request",value:{resource:e,id:n}})};g.response.addReader(function(e){var t=e.id,n=e.value;b[t](n),delete b[t]});var E=function(t,n){w("/nodes/"+t,function(r){r.kind=="error"&&r.value==404&&setTimeout(e.partial(E,t,n),500)})},S={delta:e.pipe(),mouse_position:e.pipe()},x=function(e){return function(t){e[t.kind]&&e[t.kind].write(t.value)}};m.onMessage(x(g)),g.message.addReader(x(S)),g.message.addReader(function(e){e.global_timestamp&&u.global_timestamp(h,e.global_timestamp)}),g.document_id.addReader(function(e){var t=h;h=e,e.global_timestamp&&u.global_timestamp(h,e.global_timestamp),typeof t=="function"?t(h):window.location.hash=h}),c.cursors&&(o.init(m.send),S.mouse_position.addReader(o.updateCursors)),g.document_state.addReader(e.once(function(t){v=s.make(h);if(t){var o=document.createElement("div");o.innerHTML=t;var f=o.firstChild;i.removeAllChildren(l);for(;;){var c=f.firstChild;if(!c)break;f.removeChild(c),l.appendChild(c)}i.removeAllAttributes(l),i.iterAttributes(f,function(e,t){l.setAttribute(e,t)}),i.traverse(l,function(e){var t=e.getAttribute("data-id");if(!t)return;i.set_node_id(e,t),e.removeAttribute("data-id"),n.updateState(l,e,h),a.set(e,"seen",!0)})}else i.traverse(l,function(e){if(i.isTextNode(e))return;var t=n.serializeNode(l,e,h);v.addDelta(t),m.send({kind:"delta",value:t})});i.traverse(l,function(e){n.updateState(l,e,h)});var p={},d=function(t){return e.map(t,function(e){return e.toString()}).join("-")},g=r.appliesDeltas(l,E);S.delta.addReader(function(t){var n=d(t.message_id);if(p[n])return;p[n]=!0;var r=v.changeset(t);e.each(r,g)}),n.changes(l,h,function(t){if(e.isEmpty(t))return;t=e.clone(t),t.message_id=u.message_id(h),p[d(t.message_id)]=!0,v.addDelta(t),m.send({kind:"delta",value:t})})}))},f}),requirejs(["sync"],function(e){return e}),define("root",function(){});